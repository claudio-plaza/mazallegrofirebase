(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[575],{78869:function(e,r,t){Promise.resolve().then(t.bind(t,20741))},20741:function(e,r,t){"use strict";t.d(r,{CarnetDigital:function(){return F}});var a=t(57437),i=t(2265),o=t(67048),s=t(48185),n=t(89733),l=t(80420),d=t(79055),c=t(51469),u=t(11240),m=t(36141),f=t(64341),p=t(13231),x=t(71935),g=t(36127),h=t(43193),N=t(30690),b=t(37164),v=t(86763),y=t(92033),w=t(2183),j=t(66648),C=t(1663),Z=t(2128),E=t(29973),S=t(16463),D=t(26912),A=t(49354);function F(){var e;let{loggedInUserNumeroSocio:r,isLoading:t}=(0,o.a)(),[F,P]=(0,i.useState)(null),[R,k]=(0,i.useState)(null),[I,O]=(0,i.useState)(!0),{toast:z}=(0,v.pm)();(0,S.useRouter)();let V=(0,S.useSearchParams)(),_=(0,i.useCallback)(async()=>{let e=V.get("titularId");if(t&&!e){O(!1);return}O(!0);let a=V.get("memberDni"),i=e||r;if(!i){P(null),k(null),O(!1),t||z({title:"Error",description:"No se pudo identificar al socio para mostrar el carnet.",variant:"destructive"});return}try{let e=await (0,D.g1)(i);if(P(e||null),e){if(a){var o,s,n,l;let r=e.dni===a?e.id:(null===(s=e.grupoFamiliar)||void 0===s?void 0:null===(o=s.find(e=>e.dni===a))||void 0===o?void 0:o.id)||(null===(l=e.grupoFamiliar)||void 0===l?void 0:null===(n=l.find(e=>e.dni===a))||void 0===n?void 0:n.dni)||e.id;k(r)}else k(e.id)}else k(null),i&&z({title:"Socio no encontrado",description:"No se encontr\xf3 informaci\xf3n para el socio N\xb0 ".concat(i,"."),variant:"destructive"})}catch(e){console.error("Error fetching socio data for carnet:",e),z({title:"Error",description:"No se pudo cargar la informaci\xf3n del carnet.",variant:"destructive"}),P(null),k(null)}finally{O(!1)}},[r,t,V,z]);(0,i.useEffect)(()=>{_();let e=()=>_();return window.addEventListener("sociosDBUpdated",e),()=>window.removeEventListener("sociosDBUpdated",e)},[_]);let M=F?[{value:F.id,label:"".concat(F.nombre," ").concat(F.apellido," (Titular)")},...(null===(e=F.grupoFamiliar)||void 0===e?void 0:e.map(e=>({value:e.id||e.dni,label:"".concat(e.nombre," ").concat(e.apellido," (").concat(e.relacion,")")})))||[]]:[],U=(0,i.useMemo)(()=>{var e;if(!F||!R)return null;if(R===F.id)return{id:F.id,nombre:F.nombre,apellido:F.apellido,dni:F.dni,aptoMedico:F.aptoMedico,fechaNacimiento:F.fechaNacimiento,fotoFinalUrl:F.fotoUrl||F.fotoPerfil||"https://placehold.co/150x150.png",numeroSocio:F.numeroSocio,miembroDesde:F.miembroDesde,relacion:"Titular"};let r=null===(e=F.grupoFamiliar)||void 0===e?void 0:e.find(e=>(e.id||e.dni)===R);return r?{id:r.id||r.dni,nombre:r.nombre,apellido:r.apellido,dni:r.dni,aptoMedico:r.aptoMedico,fechaNacimiento:r.fechaNacimiento,fotoFinalUrl:r.fotoPerfil||"https://placehold.co/150x150.png",relacion:r.relacion}:null},[F,R]);if(I||t&&!V.get("titularId"))return(0,a.jsxs)(s.Zb,{className:"w-full max-w-md mx-auto shadow-lg",children:[(0,a.jsx)(s.Ol,{className:"items-center text-center p-4",children:(0,a.jsx)(w.O,{className:"h-8 w-3/4"})}),(0,a.jsxs)(s.aY,{className:"p-6 space-y-6",children:[(0,a.jsx)(w.O,{className:"h-32 w-32 rounded-full mx-auto"}),(0,a.jsx)(w.O,{className:"h-6 w-5/6 mx-auto"}),(0,a.jsx)(w.O,{className:"h-4 w-3/4 mx-auto"}),(0,a.jsx)(w.O,{className:"h-4 w-1/2 mx-auto"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4 pt-4",children:[(0,a.jsx)(w.O,{className:"h-20 w-full"}),(0,a.jsx)(w.O,{className:"h-20 w-full"})]}),(0,a.jsx)(w.O,{className:"h-24 w-24 mx-auto"})]})]});if(!F||!U)return(0,a.jsxs)(s.Zb,{className:"w-full max-w-md mx-auto shadow-xl",children:[(0,a.jsx)(s.Ol,{className:"bg-destructive text-destructive-foreground p-4",children:(0,a.jsx)(s.ll,{className:"text-center text-xl",children:"Error de Datos"})}),(0,a.jsx)(s.aY,{className:"p-6",children:(0,a.jsx)("p",{className:"text-center text-muted-foreground",children:"No se pudo cargar la informaci\xf3n del carnet. Verifique el N\xb0 de Socio o DNI, o contacte a administraci\xf3n."})})]});let T=(0,y.b9)(U.aptoMedico,U.fechaNacimiento),q="Socio N\xb0: ".concat(F.numeroSocio,"\nTitular: ").concat(F.nombre," ").concat(F.apellido,"\nVerificado por: ").concat(C.J.name),L="https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=".concat(encodeURIComponent(q),"&format=png&bgcolor=ffffff&color=ed771b&qzone=1"),G=U.id===F.id;return(0,a.jsxs)(s.Zb,{className:(0,A.cn)("w-full max-w-md mx-auto shadow-2xl rounded-xl overflow-hidden border-0","bg-gradient-to-br from-primary to-secondary text-primary-foreground"),children:[(0,a.jsx)(s.Ol,{className:"p-4 text-center relative",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)(c.Z,{className:"h-8 w-8 opacity-80"}),(0,a.jsx)(s.ll,{className:"text-2xl font-bold",children:C.J.name}),(0,a.jsx)(j.default,{src:"https://placehold.co/40x40.png",alt:"[Tu Logo]",width:40,height:40,"data-ai-hint":"club logo",className:"rounded-sm opacity-90"})]})}),(0,a.jsxs)(s.aY,{className:"p-6 space-y-6",children:[M.length>1&&(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsxs)("label",{htmlFor:"select-person",className:"text-xs font-medium text-primary-foreground/80 flex items-center",children:[(0,a.jsx)(u.Z,{className:"mr-1.5 h-3.5 w-3.5"})," Ver carnet de:"]}),(0,a.jsxs)(Z.Ph,{value:R||"",onValueChange:k,children:[(0,a.jsx)(Z.i4,{id:"select-person",className:"w-full bg-background/20 text-primary-foreground border-primary-foreground/30 text-sm h-9 focus:ring-primary-foreground",children:(0,a.jsx)(Z.ki,{placeholder:"Seleccionar miembro"})}),(0,a.jsxs)(Z.Bw,{children:[" ",M.map(e=>(0,a.jsx)(Z.Ql,{value:e.value,className:"text-sm",children:e.label},e.value))]})]})]}),(0,a.jsxs)("div",{className:"text-center space-y-3",children:[(0,a.jsxs)(l.qE,{className:"h-32 w-32 border-4 border-primary-foreground/50 shadow-lg mx-auto bg-background/30",children:[(0,a.jsx)(l.F$,{src:U.fotoFinalUrl,alt:"".concat(U.nombre," ").concat(U.apellido),"data-ai-hint":"member portrait"}),(0,a.jsxs)(l.Q5,{className:"text-4xl bg-background/30 text-primary-foreground/70",children:[U.nombre[0],U.apellido[0]]})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("h2",{className:"text-2xl font-semibold text-primary-foreground",children:[U.nombre," ",U.apellido]}),(0,a.jsxs)("p",{className:"text-sm text-primary-foreground/80",children:[G?"Socio N\xb0: ".concat(U.numeroSocio):U.relacion," | DNI: ",U.dni]}),G&&U.miembroDesde&&(0,a.jsxs)("p",{className:"text-xs text-primary-foreground/70",children:["Miembro desde: ",(0,y.p6)(U.miembroDesde,"dd/MM/yy")]})]})]}),(0,a.jsx)(E.Z,{className:"bg-primary-foreground/20"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 gap-4",children:[(0,a.jsxs)("div",{className:(0,A.cn)("p-3 rounded-lg border","Activo"===F.estadoSocio?"border-green-300 bg-green-400/20 text-green-50":"border-red-300 bg-red-400/20 text-red-50"),children:[(0,a.jsx)("h3",{className:"text-xs font-medium text-primary-foreground/70 mb-1",children:"Estado Socio Titular"}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:["Activo"===F.estadoSocio?(0,a.jsx)(m.Z,{className:"h-5 w-5 text-green-200"}):(0,a.jsx)(f.Z,{className:"h-5 w-5 text-red-200"}),(0,a.jsx)(d.C,{variant:"Activo"===F.estadoSocio?"default":"destructive",className:(0,A.cn)("text-xs","Activo"===F.estadoSocio?"bg-green-500 text-white":"bg-red-500 text-white"),children:F.estadoSocio})]})]}),(0,a.jsxs)("div",{className:(0,A.cn)("p-3 rounded-lg border",T.colorClass.includes("green")?"border-green-300 bg-green-400/20 text-green-50":T.colorClass.includes("orange")?"border-orange-300 bg-orange-400/20 text-orange-50":T.colorClass.includes("gray")?"border-gray-300 bg-gray-400/20 text-gray-50":"border-red-300 bg-red-400/20 text-red-50"),children:[(0,a.jsxs)("h3",{className:"text-xs font-medium text-primary-foreground/70 mb-1",children:["Apto M\xe9dico (",U.relacion||"Titular",")"]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:["V\xe1lido"===T.status&&(0,a.jsx)(p.Z,{className:"h-5 w-5 text-green-200"}),"Vencido"===T.status&&(0,a.jsx)(x.Z,{className:"h-5 w-5 text-red-200"}),"Inv\xe1lido"===T.status&&(0,a.jsx)(g.Z,{className:"h-5 w-5 text-red-200"}),"Pendiente"===T.status&&(0,a.jsx)(h.Z,{className:"h-5 w-5 text-yellow-200"}),"No Aplica"===T.status&&(0,a.jsx)(N.Z,{className:"h-5 w-5 text-gray-200"}),(0,a.jsx)(d.C,{variant:"outline",className:(0,A.cn)("text-xs border-current",T.colorClass.includes("green")&&"text-green-100 border-green-200",T.colorClass.includes("orange")&&"text-orange-100 border-orange-200",T.colorClass.includes("red")&&"text-red-100 border-red-200",T.colorClass.includes("yellow")&&"text-yellow-100 border-yellow-200",T.colorClass.includes("gray")&&"text-gray-100 border-gray-200"),children:T.status})]}),(0,a.jsx)("p",{className:"text-xs mt-1 text-primary-foreground/90",children:T.message})]})]}),(0,a.jsx)(E.Z,{className:"bg-primary-foreground/20"}),(0,a.jsxs)("div",{className:"flex flex-col items-center space-y-2 pt-2",children:[(0,a.jsx)(j.default,{src:L,alt:"QR Code para ".concat(F.numeroSocio),width:150,height:150,className:"rounded-lg shadow-md border-4 border-white bg-white p-1","data-ai-hint":"access qr code"}),(0,a.jsx)("p",{className:"text-xs text-primary-foreground/70 text-center px-4",children:"Presentar este c\xf3digo para ingreso y gestiones. V\xe1lido para todo el grupo familiar."})]})]}),(0,a.jsx)(s.eW,{className:"p-4 bg-black/10 border-t border-primary-foreground/20",children:(0,a.jsxs)(n.z,{onClick:()=>{z({title:"Funci\xf3n no implementada",description:"La descarga de PDF ser\xe1 implementada pr\xf3ximamente."})},variant:"outline",size:"sm",className:"w-full bg-primary-foreground/10 border-primary-foreground/30 text-primary-foreground hover:bg-primary-foreground/20",children:[(0,a.jsx)(b.Z,{className:"mr-2 h-4 w-4"}),"Descargar PDF (Pr\xf3ximamente)"]})})]})}},80420:function(e,r,t){"use strict";t.d(r,{F$:function(){return l},Q5:function(){return d},qE:function(){return n}});var a=t(57437),i=t(2265),o=t(44458),s=t(49354);let n=i.forwardRef((e,r)=>{let{className:t,...i}=e;return(0,a.jsx)(o.fC,{ref:r,className:(0,s.cn)("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",t),...i})});n.displayName=o.fC.displayName;let l=i.forwardRef((e,r)=>{let{className:t,...i}=e;return(0,a.jsx)(o.Ee,{ref:r,className:(0,s.cn)("aspect-square h-full w-full",t),...i})});l.displayName=o.Ee.displayName;let d=i.forwardRef((e,r)=>{let{className:t,...i}=e;return(0,a.jsx)(o.NY,{ref:r,className:(0,s.cn)("flex h-full w-full items-center justify-center rounded-full bg-muted",t),...i})});d.displayName=o.NY.displayName},79055:function(e,r,t){"use strict";t.d(r,{C:function(){return n}});var a=t(57437);t(2265);var i=t(13027),o=t(49354);let s=(0,i.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function n(e){let{className:r,variant:t,...i}=e;return(0,a.jsx)("div",{className:(0,o.cn)(s({variant:t}),r),...i})}},48185:function(e,r,t){"use strict";t.d(r,{Ol:function(){return n},SZ:function(){return d},Zb:function(){return s},aY:function(){return c},eW:function(){return u},ll:function(){return l}});var a=t(57437),i=t(2265),o=t(49354);let s=i.forwardRef((e,r)=>{let{className:t,...i}=e;return(0,a.jsx)("div",{ref:r,className:(0,o.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",t),...i})});s.displayName="Card";let n=i.forwardRef((e,r)=>{let{className:t,...i}=e;return(0,a.jsx)("div",{ref:r,className:(0,o.cn)("flex flex-col space-y-1.5 p-6",t),...i})});n.displayName="CardHeader";let l=i.forwardRef((e,r)=>{let{className:t,...i}=e;return(0,a.jsx)("div",{ref:r,className:(0,o.cn)("text-2xl font-semibold leading-none tracking-tight",t),...i})});l.displayName="CardTitle";let d=i.forwardRef((e,r)=>{let{className:t,...i}=e;return(0,a.jsx)("div",{ref:r,className:(0,o.cn)("text-sm text-muted-foreground",t),...i})});d.displayName="CardDescription";let c=i.forwardRef((e,r)=>{let{className:t,...i}=e;return(0,a.jsx)("div",{ref:r,className:(0,o.cn)("p-6 pt-0",t),...i})});c.displayName="CardContent";let u=i.forwardRef((e,r)=>{let{className:t,...i}=e;return(0,a.jsx)("div",{ref:r,className:(0,o.cn)("flex items-center p-6 pt-0",t),...i})});u.displayName="CardFooter"},2128:function(e,r,t){"use strict";t.d(r,{Bw:function(){return x},Ph:function(){return c},Ql:function(){return g},i4:function(){return m},ki:function(){return u}});var a=t(57437),i=t(2265),o=t(19825),s=t(42421),n=t(14392),l=t(22468),d=t(49354);let c=o.fC;o.ZA;let u=o.B4,m=i.forwardRef((e,r)=>{let{className:t,children:i,...n}=e;return(0,a.jsxs)(o.xz,{ref:r,className:(0,d.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",t),...n,children:[i,(0,a.jsx)(o.JO,{asChild:!0,children:(0,a.jsx)(s.Z,{className:"h-4 w-4 opacity-50"})})]})});m.displayName=o.xz.displayName;let f=i.forwardRef((e,r)=>{let{className:t,...i}=e;return(0,a.jsx)(o.u_,{ref:r,className:(0,d.cn)("flex cursor-default items-center justify-center py-1",t),...i,children:(0,a.jsx)(n.Z,{className:"h-4 w-4"})})});f.displayName=o.u_.displayName;let p=i.forwardRef((e,r)=>{let{className:t,...i}=e;return(0,a.jsx)(o.$G,{ref:r,className:(0,d.cn)("flex cursor-default items-center justify-center py-1",t),...i,children:(0,a.jsx)(s.Z,{className:"h-4 w-4"})})});p.displayName=o.$G.displayName;let x=i.forwardRef((e,r)=>{let{className:t,children:i,position:s="popper",...n}=e;return(0,a.jsx)(o.h_,{children:(0,a.jsxs)(o.VY,{ref:r,className:(0,d.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===s&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:s,...n,children:[(0,a.jsx)(f,{}),(0,a.jsx)(o.l_,{className:(0,d.cn)("p-1","popper"===s&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:i}),(0,a.jsx)(p,{})]})})});x.displayName=o.VY.displayName,i.forwardRef((e,r)=>{let{className:t,...i}=e;return(0,a.jsx)(o.__,{ref:r,className:(0,d.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",t),...i})}).displayName=o.__.displayName;let g=i.forwardRef((e,r)=>{let{className:t,children:i,...s}=e;return(0,a.jsxs)(o.ck,{ref:r,className:(0,d.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...s,children:[(0,a.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,a.jsx)(o.wU,{children:(0,a.jsx)(l.Z,{className:"h-4 w-4"})})}),(0,a.jsx)(o.eT,{children:i})]})});g.displayName=o.ck.displayName,i.forwardRef((e,r)=>{let{className:t,...i}=e;return(0,a.jsx)(o.Z0,{ref:r,className:(0,d.cn)("-mx-1 my-1 h-px bg-muted",t),...i})}).displayName=o.Z0.displayName},29973:function(e,r,t){"use strict";t.d(r,{Z:function(){return n}});var a=t(57437),i=t(2265),o=t(48484),s=t(49354);let n=i.forwardRef((e,r)=>{let{className:t,orientation:i="horizontal",decorative:n=!0,...l}=e;return(0,a.jsx)(o.f,{ref:r,decorative:n,orientation:i,className:(0,s.cn)("shrink-0 bg-border","horizontal"===i?"h-[1px] w-full":"h-full w-[1px]",t),...l})});n.displayName=o.f.displayName},2183:function(e,r,t){"use strict";t.d(r,{O:function(){return o}});var a=t(57437),i=t(49354);function o(e){let{className:r,...t}=e;return(0,a.jsx)("div",{className:(0,i.cn)("animate-pulse rounded-md bg-muted",r),...t})}},1663:function(e,r,t){"use strict";t.d(r,{J:function(){return f},Q:function(){return p}});var a=t(54174),i=t(11240),o=t(22023),s=t(43267),n=t(86162),l=t(82244),d=t(36141),c=t(72377),u=t(51077),m=t(56143);let f={name:"Allegro",description:"Sistema de gesti\xf3n integral para un club deportivo y social."},p=[{id:"mi-perfil-vista",title:"Mi Perfil",description:"Visualiza tus datos personales y de membres\xeda.",icon:a.Z,href:"/mi-perfil",roles:["socio"]},{id:"gestionar-familiares",title:"Gestionar Grupo Familiar",description:"Agrega o modifica los datos de tu grupo familiar.",icon:i.Z,href:"/perfil",roles:["socio"]},{id:"carnet-digital",title:"Carnet Digital",description:"Accede a tu carnet de socio digital.",icon:o.Z,href:"/carnet",roles:["socio"]},{id:"invitados-diarios",title:"Cargar Invitados del D\xeda",description:"Registra tus invitados para el acceso diario.",icon:s.Z,href:"/invitados-diarios",roles:["socio"]},{id:"mis-adherentes",title:"Mis Adherentes",description:"Gestiona tus adherentes y sus solicitudes.",icon:n.Z,href:"/mis-adherentes",roles:["socio"]},{id:"gestion-socios",title:"Gesti\xf3n de Socios",description:"Administra la base de datos de socios.",icon:i.Z,href:"/admin/gestion-socios",roles:["admin"]},{id:"panel-medico",title:"Panel M\xe9dico",description:"Gestiona revisiones m\xe9dicas y aptos f\xedsicos.",icon:l.Z,href:"/admin/panel-medico",roles:["medico","admin"]},{id:"control-acceso",title:"Control de Acceso",description:"Verifica el estado de socios para el ingreso.",icon:d.Z,href:"/admin/control-acceso",roles:["portero","admin"]},{id:"gestion-invitados-diarios-admin",title:"Listas de Invitados",description:"Revisa y descarga listas de invitados diarios.",icon:c.Z,href:"/admin/gestion-invitados-diarios",roles:["admin"]},{id:"configuracion-precios",title:"Configurar Precios",description:"Establece los precios de las entradas para invitados.",icon:u.Z,href:"/admin/configuracion-precios",roles:["admin"]},{id:"gestion-novedades",title:"Gesti\xf3n de Novedades",description:"Crea y administra novedades y alertas.",icon:m.Z,href:"/admin/gestion-novedades",roles:["admin"]}]},39630:function(e,r,t){"use strict";t.d(r,{H:function(){return u},V:function(){return c}});var a=t(57437),i=t(2265),o=t(75735),s=t(25419),n=t(26912),l=t(94282),d=t(86763);let c=(0,i.createContext)(void 0),u=e=>{let{children:r}=e,[t,u]=(0,i.useState)(null),[m,f]=(0,i.useState)(null),[p,x]=(0,i.useState)(null),[g,h]=(0,i.useState)(null),[N,b]=(0,i.useState)(!0);(0,i.useEffect)(()=>{let e=()=>{};return s.I8&&(e=(0,o.Aj)(s.I8,async e=>{if(b(!0),e){u(e),console.log("Firebase Auth UID for logged-in user:",e.uid);try{let r=await (0,n.AZ)(e.uid);if(r)f(r.role),x("".concat(r.nombre," ").concat(r.apellido)),h(r.numeroSocio);else{let r=await (0,n.Xt)(e.uid);r?(f(r.role),x(r.name)):(console.warn("User with UID ".concat(e.uid," and email ").concat(e.email," is authenticated but has no profile in 'socios' or 'adminUsers' collections. Assign a role in Firestore to grant access.")),f(null),x(e.displayName||e.email)),h(null)}}catch(r){console.error("AuthContext: Failed to fetch user profile from Firestore.",r),(0,d.Am)({title:"Error de Permisos o Conexi\xf3n",description:"No se pudo cargar tu perfil. Esto puede deberse a un problema de conexi\xf3n o a que las reglas de seguridad de Firestore no permiten el acceso. Contacte al administrador.",variant:"destructive",duration:1e4}),f(null),x(e.displayName||e.email),h(null)}}else u(null),f(null),x(null),h(null);b(!1)})),()=>e()},[]);let v=async()=>{await (0,l.TX)()};return(0,a.jsx)(c.Provider,{value:{isLoggedIn:!!t,user:t,userRole:m,userName:p,loggedInUserNumeroSocio:g,isLoading:N,logout:v},children:r})}},67048:function(e,r,t){"use strict";t.d(r,{a:function(){return o}});var a=t(2265),i=t(39630);let o=()=>{let e=(0,a.useContext)(i.V);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},94282:function(e,r,t){"use strict";t.d(r,{EL:function(){return l},TX:function(){return d},pH:function(){return n}});var a=t(75735),i=t(25419),o=t(86763),s=t(26912);let n=async(e,r)=>{try{if(!i.I8)throw Error("Auth service not initialized.");return(await (0,a.e5)(i.I8,e,r)).user}catch(e){return console.error("Firebase login error:",e),(0,o.Am)({title:"Error de Inicio de Sesi\xf3n",description:"Email o contrase\xf1a incorrectos. Por favor, intente de nuevo.",variant:"destructive"}),null}},l=async e=>{try{if(!i.I8)throw Error("Auth service not initialized.");let r=(await (0,a.Xb)(i.I8,e.email,e.password)).user;await (0,a.ck)(r,{displayName:"".concat(e.nombre," ").concat(e.apellido)});let t=async(e,t)=>e instanceof FileList&&e.length>0?(0,s.cT)(e[0],"socios/".concat(r.uid,"/").concat(t)):null,[o,n,l,d]=await Promise.all([t(e.fotoPerfil,"fotoPerfil.jpg"),t(e.fotoDniFrente,"fotoDniFrente.jpg"),t(e.fotoDniDorso,"fotoDniDorso.jpg"),t(e.fotoCarnet,"fotoCarnet.jpg")]),c={email:e.email,nombre:e.nombre,apellido:e.apellido,fechaNacimiento:e.fechaNacimiento,dni:e.dni,empresa:e.empresa,telefono:e.telefono,direccion:e.direccion,fotoUrl:o,fotoPerfil:o,fotoDniFrente:n,fotoDniDorso:l,fotoCarnet:d,grupoFamiliar:[]};return await (0,s.l1)(r.uid,c,!0),r}catch(r){console.error("Firebase signup error:",r);let e="Ocurri\xf3 un error inesperado al crear la cuenta.";return"auth/email-already-in-use"===r.code&&(e="El email ingresado ya est\xe1 en uso. Por favor, utilice otro."),(0,o.Am)({title:"Error de Registro",description:e,variant:"destructive"}),null}},d=async()=>{try{if(!i.I8)throw Error("Auth service not initialized.");await (0,a.w7)(i.I8)}catch(e){console.error("Error signing out:",e),(0,o.Am)({title:"Error",description:"No se pudo cerrar la sesi\xf3n.",variant:"destructive"})}}}},function(e){e.O(0,[4358,139,4868,317,4414,8173,2978,4187,7467,6068,2971,7023,1744],function(){return e(e.s=78869)}),_N_E=e.O()}]);