(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4550,2371,1262],{51484:function(e,i,a){Promise.resolve().then(a.bind(a,31164))},87385:function(e,i,a){"use strict";a.d(i,{Z:function(){return r}});/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,a(78030).Z)("CalendarDays",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]])},70518:function(e,i,a){"use strict";a.d(i,{Z:function(){return r}});/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,a(78030).Z)("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]])},87592:function(e,i,a){"use strict";a.d(i,{Z:function(){return r}});/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,a(78030).Z)("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]])},96273:function(e,i,a){"use strict";a.d(i,{Z:function(){return r}});/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,a(78030).Z)("CirclePlus",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]])},22584:function(e,i,a){"use strict";a.d(i,{Z:function(){return r}});/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,a(78030).Z)("CloudUpload",[["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"M12 12v9",key:"192myk"}],["path",{d:"m16 16-4-4-4 4",key:"119tzi"}]])},22023:function(e,i,a){"use strict";a.d(i,{Z:function(){return r}});/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,a(78030).Z)("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]])},30690:function(e,i,a){"use strict";a.d(i,{Z:function(){return r}});/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,a(78030).Z)("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]])},13622:function(e,i,a){"use strict";a.d(i,{Z:function(){return r}});/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,a(78030).Z)("MailQuestion",[["path",{d:"M22 10.5V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v12c0 1.1.9 2 2 2h12.5",key:"e61zoh"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}],["path",{d:"M18 15.28c.2-.4.5-.8.9-1a2.1 2.1 0 0 1 2.6.4c.3.4.5.8.5 1.3 0 1.3-2 2-2 2",key:"7z9rxb"}],["path",{d:"M20 22v.01",key:"12bgn6"}]])},90221:function(e,i,a){"use strict";a.d(i,{Z:function(){return r}});/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,a(78030).Z)("SquareX",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]])},10883:function(e,i,a){"use strict";a.d(i,{Z:function(){return r}});/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,a(78030).Z)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]])},11240:function(e,i,a){"use strict";a.d(i,{Z:function(){return r}});/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,a(78030).Z)("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]])},66648:function(e,i,a){"use strict";a.d(i,{default:function(){return t.a}});var r=a(55601),t=a.n(r)},55601:function(e,i,a){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),function(e,i){for(var a in i)Object.defineProperty(e,a,{enumerable:!0,get:i[a]})}(i,{default:function(){return o},getImageProps:function(){return l}});let r=a(99920),t=a(80497),s=a(38173),n=r._(a(21241));function l(e){let{props:i}=(0,t.getImgProps)(e,{defaultLoader:n.default,imgConf:{deviceSizes:[640,750,828,1080,1200,1920,2048,3840],imageSizes:[16,32,48,64,96,128,256,384],path:"/_next/image",loader:"default",dangerouslyAllowSVG:!1,unoptimized:!1}});for(let[e,a]of Object.entries(i))void 0===a&&delete i[e];return{props:i}}let o=s.Image},60291:function(e,i,a){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),Object.defineProperty(i,"RouterContext",{enumerable:!0,get:function(){return r}});let r=a(99920)._(a(2265)).default.createContext(null)},31164:function(e,i,a){"use strict";a.d(i,{AltaSocioMultiStepForm:function(){return G}});var r=a(57437),t=a(2265),s=a(39343),n=a(31014),l=a(59772),o=a(89733),d=a(48185),c=a(77209),u=a(93363),m=a(86763),f=a(30690),h=a(13622),p=a(90221),x=a(78030);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let j=(0,x.Z)("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]),g=(0,x.Z)("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]);var b=a(11240),v=a(96273),y=a(10883),N=a(87385),D=a(70518),F=a(87592),w=a(97e3),I=a(80624),C=a(67048),k=a(64451),E=a(92033),z=a(26912),M=a(87992),P=a(81262);function G(){var e,i,a,x,G;let[Z,A]=(0,t.useState)(1),{toast:S}=(0,m.pm)(),{loggedInUserNumeroSocio:H,isLoading:X}=(0,C.a)(),[O,_]=(0,t.useState)(null),[J,W]=(0,t.useState)(!0),[R,q]=(0,t.useState)(null),[T,U]=(0,t.useState)("");(0,t.useEffect)(()=>{U((0,w.WU)(new Date,"yyyy-MM-dd"))},[]);let L=(0,s.cI)({resolver:async(e,i,a)=>{let r;if(1===Z){let t=l.z.object({tipoGrupoFamiliar:l.z.enum(["conyugeEHijos","padresMadres"],{required_error:"Debe seleccionar un tipo de grupo familiar."})});r=await (0,n.F)(t)(e,i,a)}else r=await (0,n.F)(k.ms)(e,i,a);return r},mode:"onChange",defaultValues:{tipoGrupoFamiliar:void 0,familiares:{conyuge:null,hijos:[],padres:[]}}}),{control:V,trigger:$,handleSubmit:Y,watch:Q,setValue:B,getValues:K,reset:ee,formState:{errors:ei}}=L,{fields:ea,append:er,remove:et}=(0,s.Dq)({control:V,name:"familiares.hijos"}),{fields:es,append:en,remove:el}=(0,s.Dq)({control:V,name:"familiares.padres"}),eo=Q("tipoGrupoFamiliar"),ed=(0,t.useCallback)(async()=>{if(!H||X)return;W(!0);let e=await (0,z.g1)(H);if(_(e),e){var i,a,r,t,s,n,l,o,d;let c=null;(null===(i=e.grupoFamiliar)||void 0===i?void 0:i.some(e=>e.relacion===k.$g.CONYUGE))||(null===(a=e.grupoFamiliar)||void 0===a?void 0:a.some(e=>e.relacion===k.$g.HIJO_A))?c="conyugeEHijos":(null===(r=e.grupoFamiliar)||void 0===r?void 0:r.some(e=>e.relacion===k.$g.PADRE_MADRE))&&(c="padresMadres"),q(c);let u=e.estadoCambioGrupoFamiliar===k.z_.PENDIENTE&&e.cambiosPendientesGrupoFamiliar?e.cambiosPendientesGrupoFamiliar:{tipoGrupoFamiliar:c,familiares:{conyuge:(null===(t=e.grupoFamiliar)||void 0===t?void 0:t.find(e=>e.relacion===k.$g.CONYUGE))||null,hijos:(null===(s=e.grupoFamiliar)||void 0===s?void 0:s.filter(e=>e.relacion===k.$g.HIJO_A))||[],padres:(null===(n=e.grupoFamiliar)||void 0===n?void 0:n.filter(e=>e.relacion===k.$g.PADRE_MADRE))||[]}};u.tipoGrupoFamiliar&&u.tipoGrupoFamiliar&&B("tipoGrupoFamiliar",u.tipoGrupoFamiliar);let m=null===(l=u.familiares)||void 0===l?void 0:l.conyuge,f=null===(o=u.familiares)||void 0===o?void 0:o.hijos,h=null===(d=u.familiares)||void 0===d?void 0:d.padres;B("familiares.conyuge",m?{...m,relacion:k.$g.CONYUGE,fechaNacimiento:m.fechaNacimiento,fotoDniFrente:"string"==typeof m.fotoDniFrente?m.fotoDniFrente:null,fotoDniDorso:"string"==typeof m.fotoDniDorso?m.fotoDniDorso:null,fotoPerfil:"string"==typeof m.fotoPerfil?m.fotoPerfil:null}:null),B("familiares.hijos",(null==f?void 0:f.map(e=>({...e,relacion:k.$g.HIJO_A,fechaNacimiento:e.fechaNacimiento,fotoDniFrente:"string"==typeof e.fotoDniFrente?e.fotoDniFrente:null,fotoDniDorso:"string"==typeof e.fotoDniDorso?e.fotoDniDorso:null,fotoPerfil:"string"==typeof e.fotoPerfil?e.fotoPerfil:null})))||[]),B("familiares.padres",(null==h?void 0:h.map(e=>({...e,relacion:k.$g.PADRE_MADRE,fechaNacimiento:e.fechaNacimiento,fotoDniFrente:"string"==typeof e.fotoDniFrente?e.fotoDniFrente:null,fotoDniDorso:"string"==typeof e.fotoDniDorso?e.fotoDniDorso:null,fotoPerfil:"string"==typeof e.fotoPerfil?e.fotoPerfil:null})))||[])}W(!1)},[H,X,B]);(0,t.useEffect)(()=>(ed(),window.addEventListener("sociosDBUpdated",ed),()=>{window.removeEventListener("sociosDBUpdated",ed)}),[ed]);let ec=async()=>{if(1===Z?await $(["tipoGrupoFamiliar"]):2!==Z||await $(["familiares"]))Z<3&&A(e=>e+1);else{let e="Por favor, corrija los errores en el formulario.";1===Z&&ei.tipoGrupoFamiliar?e=ei.tipoGrupoFamiliar.message||"Por favor, seleccione un tipo de grupo familiar para continuar.":2===Z&&ei.familiares&&ei.familiares.message?e=ei.familiares.message:2===Z&&ei.familiares&&(e="Verifique los datos de los familiares."),S({title:"Error de Validaci\xf3n",description:e,variant:"destructive"})}},eu=async e=>{if(!O){S({title:"Error",description:"No se pudieron cargar los datos del socio titular.",variant:"destructive"});return}if(O.estadoCambioGrupoFamiliar===k.z_.PENDIENTE){S({title:"Solicitud en Curso",description:"Ya tiene una solicitud pendiente de aprobaci\xf3n.",variant:"default"});return}let i=async(e,i,a)=>e instanceof FileList&&e.length>0?(0,z.cT)(e[0],"socios/".concat(O.id,"/familiares/").concat(i,"_").concat(a,".jpg")):"string"==typeof e?e:null,a=async e=>{if(!e)return null;let a=e.id||(0,E.Ox)(),[r,t,s,n]=await Promise.all([i(e.fotoPerfil,a,"perfil"),i(e.fotoDniFrente,a,"dniFrente"),i(e.fotoDniDorso,a,"dniDorso"),i(e.fotoCarnet,a,"carnet")]);return{...e,id:a,fechaNacimiento:e.fechaNacimiento,fotoPerfil:r,fotoDniFrente:t,fotoDniDorso:s,fotoCarnet:n}},r={tipoGrupoFamiliar:e.tipoGrupoFamiliar,familiares:{conyuge:await a(e.familiares.conyuge),hijos:await Promise.all((e.familiares.hijos||[]).map(a)),padres:await Promise.all((e.familiares.padres||[]).map(a))}},t={...O,cambiosPendientesGrupoFamiliar:r,estadoCambioGrupoFamiliar:k.z_.PENDIENTE,motivoRechazoCambioGrupoFamiliar:null};try{await (0,z.uL)(t),S({title:"Solicitud de Cambio Enviada",description:"Tus cambios en el grupo familiar han sido enviados para aprobaci\xf3n."}),ed(),A(1)}catch(e){console.error("Error actualizando socio con cambios pendientes:",e),S({title:"Error",description:"No se pudo enviar la solicitud de cambio.",variant:"destructive"})}};if((0,t.useEffect)(()=>{let e=Q((e,i)=>{let{name:a,type:r}=i;if("tipoGrupoFamiliar"===a&&"change"===r){let i=e.tipoGrupoFamiliar;(null==O?void 0:O.estadoCambioGrupoFamiliar)!==k.z_.PENDIENTE&&("conyugeEHijos"===i?B("familiares.padres",[]):"padresMadres"===i&&(B("familiares.conyuge",null),B("familiares.hijos",[])))}});return()=>e.unsubscribe()},[Q,B,null==O?void 0:O.estadoCambioGrupoFamiliar]),J||X)return(0,r.jsx)("p",{className:"text-center py-10",children:"Cargando datos del perfil..."});if(!O&&!X&&!J)return(0,r.jsx)("p",{className:"text-center py-10 text-destructive",children:"Error al cargar datos del socio. Por favor, intente recargar."});let em=(null==O?void 0:O.estadoCambioGrupoFamiliar)===k.z_.PENDIENTE,ef=!!R||em;return(0,r.jsx)(s.RV,{...L,children:(0,r.jsxs)(d.Zb,{className:"w-full max-w-3xl mx-auto",children:[(0,r.jsxs)(d.Ol,{children:[(0,r.jsx)(d.ll,{children:"Gestionar Grupo Familiar"}),(0,r.jsxs)(d.SZ,{children:["Paso ",Z," de ",3," - ",1===Z?"Selecci\xf3n de tipo de grupo":2===Z?"Detalles de familiares":"Revisi\xf3n final"]}),(0,r.jsxs)(M.bZ,{variant:"default",className:"mt-4 bg-primary/10 border-primary/30 text-primary",children:[(0,r.jsx)(f.Z,{className:"h-5 w-5"}),(0,r.jsx)(M.Cd,{className:"font-semibold",children:"Informaci\xf3n sobre Modificaciones"}),(0,r.jsx)(M.X,{children:"Cualquier cambio que realice aqu\xed a su grupo familiar (agregar, quitar o modificar datos de familiares, incluyendo fotos) se enviar\xe1 como una solicitud que deber\xe1 ser aprobada por la administraci\xf3n."})]}),em&&(0,r.jsxs)(M.bZ,{variant:"default",className:"mt-4 bg-yellow-500/10 border-yellow-500/30 text-yellow-700",children:[(0,r.jsx)(h.Z,{className:"h-5 w-5"}),(0,r.jsx)(M.Cd,{className:"font-semibold",children:"Solicitud Pendiente"}),(0,r.jsx)(M.X,{children:"Tiene una solicitud de cambio para su grupo familiar pendiente de aprobaci\xf3n. No podr\xe1 realizar nuevas solicitudes hasta que la actual sea procesada. Si desea cancelar la solicitud actual, contacte a administraci\xf3n."})]}),(null==O?void 0:O.estadoCambioGrupoFamiliar)===k.z_.RECHAZADO&&(0,r.jsxs)(M.bZ,{variant:"destructive",className:"mt-4",children:[(0,r.jsx)(p.Z,{className:"h-5 w-5"}),(0,r.jsx)(M.Cd,{className:"font-semibold",children:"Solicitud Rechazada"}),(0,r.jsxs)(M.X,{children:["Su \xfaltima solicitud de cambio fue rechazada. Motivo: ",O.motivoRechazoCambioGrupoFamiliar||"No especificado",". Puede realizar una nueva solicitud corrigiendo los datos."]})]}),R&&!em&&1===Z&&(0,r.jsxs)(M.bZ,{variant:"default",className:"mt-4 bg-secondary/10 border-secondary/30 text-secondary",children:[(0,r.jsx)(j,{className:"h-5 w-5 text-secondary"}),(0,r.jsx)(M.Cd,{className:"font-semibold text-secondary",children:"Tipo de Grupo Establecido"}),(0,r.jsxs)(M.X,{children:["Actualmente tiene un grupo familiar de tipo: ",(0,r.jsx)("strong",{children:"conyugeEHijos"===R?"C\xf3nyuge e Hijos/as":"Padres/Madres"}),". Si necesita cambiar el tipo de grupo fundamental, deber\xe1 contactar a la administraci\xf3n, ya que esta selecci\xf3n est\xe1 bloqueada. Puede editar los miembros dentro del tipo actual en el siguiente paso."]})]}),(0,r.jsx)("div",{className:"w-full bg-muted rounded-full h-2.5 mt-2",children:(0,r.jsx)("div",{className:"bg-primary h-2.5 rounded-full",style:{width:"".concat(Z/3*100,"%")}})})]}),(0,r.jsxs)("form",{onSubmit:Y(eu),children:[(0,r.jsxs)(d.aY,{className:"space-y-6",children:[1===Z&&(0,r.jsxs)("section",{children:[(0,r.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Tipo de Grupo Familiar"}),(0,r.jsx)(u.Wi,{control:V,name:"tipoGrupoFamiliar",render:e=>{let{field:i}=e;return(0,r.jsxs)(u.xJ,{className:"space-y-3",children:[(0,r.jsx)(u.lX,{className:ef?"text-muted-foreground":"",children:ef?"Tipo de grupo actual (bloqueado):":"\xbfQu\xe9 tipo de grupo familiar desea registrar o modificar?"}),(0,r.jsx)(u.NI,{children:(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4",children:[(0,r.jsx)(o.z,{type:"button",variant:"conyugeEHijos"===i.value?"default":"outline",onClick:()=>i.onChange("conyugeEHijos"),className:"flex-1 justify-start p-6 text-left h-auto",disabled:ef,children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)(g,{className:"mr-3 h-6 w-6 text-red-500"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"font-semibold",children:"C\xf3nyuge e Hijos/as"}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:"Agregue los datos de su c\xf3nyuge y/o hijos."})]})]})}),(0,r.jsx)(o.z,{type:"button",variant:"padresMadres"===i.value?"default":"outline",onClick:()=>i.onChange("padresMadres"),className:"flex-1 justify-start p-6 text-left h-auto",disabled:ef,children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)(b.Z,{className:"mr-3 h-6 w-6 text-secondary"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"font-semibold",children:"Padres/Madres"}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:"Agregue los datos de sus padres o madres."})]})]})})]})}),(0,r.jsx)(u.zG,{})]})}})]}),2===Z&&(0,r.jsxs)("section",{children:[(0,r.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"Datos del Grupo Familiar"}),!eo&&(0,r.jsx)("p",{className:"text-destructive",children:"Por favor, regrese al paso anterior y seleccione un tipo de grupo familiar."}),"conyugeEHijos"===eo&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"mb-6 p-4 border rounded-md",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,r.jsx)("h4",{className:"text-md font-semibold",children:"Datos del C\xf3nyuge"}),Q("familiares.conyuge")?(0,r.jsxs)(o.z,{type:"button",size:"sm",variant:"destructive",onClick:()=>B("familiares.conyuge",null),disabled:em,children:[(0,r.jsx)(y.Z,{className:"mr-2 h-4 w-4"})," Quitar C\xf3nyuge"]}):(0,r.jsxs)(o.z,{type:"button",size:"sm",variant:"outline",onClick:()=>B("familiares.conyuge",{apellido:"",nombre:"",fechaNacimiento:new Date,dni:"",relacion:k.$g.CONYUGE,fotoDniFrente:null,fotoDniDorso:null,fotoPerfil:null,telefono:"",direccion:"",email:""}),disabled:em,children:[(0,r.jsx)(v.Z,{className:"mr-2 h-4 w-4"})," Agregar C\xf3nyuge"]})]}),Q("familiares.conyuge")&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsx)(u.Wi,{control:V,name:"familiares.conyuge.apellido",render:e=>{let{field:i}=e;return(0,r.jsxs)(u.xJ,{children:[" ",(0,r.jsx)(u.lX,{children:"Apellido C\xf3nyuge"})," ",(0,r.jsx)(u.NI,{children:(0,r.jsx)(c.I,{...i,disabled:em})})," ",(0,r.jsx)(u.zG,{})," "]})}}),(0,r.jsx)(u.Wi,{control:V,name:"familiares.conyuge.nombre",render:e=>{let{field:i}=e;return(0,r.jsxs)(u.xJ,{children:[" ",(0,r.jsx)(u.lX,{children:"Nombre C\xf3nyuge"})," ",(0,r.jsx)(u.NI,{children:(0,r.jsx)(c.I,{...i,disabled:em})})," ",(0,r.jsx)(u.zG,{})," "]})}}),(0,r.jsx)(u.Wi,{control:V,name:"familiares.conyuge.fechaNacimiento",render:e=>{let{field:i}=e;return(0,r.jsxs)(u.xJ,{children:[(0,r.jsx)(u.lX,{children:"Fecha Nac. C\xf3nyuge"}),(0,r.jsx)(u.NI,{children:(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(N.Z,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground pointer-events-none"}),(0,r.jsx)(c.I,{type:"date",value:i.value?(0,w.WU)(new Date(i.value),"yyyy-MM-dd"):"",onChange:e=>i.onChange(e.target.value?(0,I.D)(e.target.value):null),className:"w-full pl-10",max:T,min:"1900-01-01",disabled:em||!T})]})}),(0,r.jsx)(u.zG,{})]})}}),(0,r.jsx)(u.Wi,{control:V,name:"familiares.conyuge.dni",render:e=>{let{field:i}=e;return(0,r.jsxs)(u.xJ,{children:[" ",(0,r.jsx)(u.lX,{children:"DNI C\xf3nyuge"})," ",(0,r.jsx)(u.NI,{children:(0,r.jsx)(c.I,{type:"number",...i,disabled:em})})," ",(0,r.jsx)(u.zG,{})," "]})}}),(0,r.jsx)(u.Wi,{control:V,name:"familiares.conyuge.telefono",render:e=>{let{field:i}=e;return(0,r.jsxs)(u.xJ,{children:[" ",(0,r.jsx)(u.lX,{children:"Tel\xe9fono (Opcional)"})," ",(0,r.jsx)(u.NI,{children:(0,r.jsx)(c.I,{type:"tel",...i,disabled:em})})," ",(0,r.jsx)(u.zG,{})," "]})}}),(0,r.jsx)(u.Wi,{control:V,name:"familiares.conyuge.direccion",render:e=>{let{field:i}=e;return(0,r.jsxs)(u.xJ,{children:[" ",(0,r.jsx)(u.lX,{children:"Direcci\xf3n (Opcional)"})," ",(0,r.jsx)(u.NI,{children:(0,r.jsx)(c.I,{...i,disabled:em})})," ",(0,r.jsx)(u.zG,{})," "]})}}),(0,r.jsx)(u.Wi,{control:V,name:"familiares.conyuge.email",render:e=>{let{field:i}=e;return(0,r.jsxs)(u.xJ,{className:"md:col-span-2",children:[" ",(0,r.jsx)(u.lX,{children:"Email (Opcional)"})," ",(0,r.jsx)(u.NI,{children:(0,r.jsx)(c.I,{type:"email",...i,disabled:em})})," ",(0,r.jsx)(u.zG,{})," "]})}})]}),(0,r.jsx)("h5",{className:"text-sm font-semibold mt-4 mb-2",children:"Documentaci\xf3n C\xf3nyuge"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,r.jsx)(P.FileInput,{name:"familiares.conyuge.fotoDniFrente",label:"DNI Frente",control:V,disabled:em}),(0,r.jsx)(P.FileInput,{name:"familiares.conyuge.fotoDniDorso",label:"DNI Dorso",control:V,disabled:em}),(0,r.jsx)(P.FileInput,{name:"familiares.conyuge.fotoPerfil",label:"Foto Perfil",control:V,disabled:em})]})]})]}),(0,r.jsxs)("div",{className:"mb-6 p-4 border rounded-md",children:[(0,r.jsxs)("h4",{className:"text-md font-semibold mb-2",children:["Datos de Hijos/as (hasta ",k.fk,")"]}),ea.map((e,i)=>(0,r.jsxs)("div",{className:"mb-4 p-4 border rounded-md relative bg-muted/20",children:[(0,r.jsxs)(o.z,{type:"button",variant:"ghost",size:"icon",className:"absolute top-2 right-2 text-destructive hover:bg-destructive/10",onClick:()=>et(i),disabled:em,children:[" ",(0,r.jsx)(y.Z,{className:"h-4 w-4"})," "]}),(0,r.jsxs)("p",{className:"font-medium mb-2",children:["Hijo/a ",i+1]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsx)(u.Wi,{control:V,name:"familiares.hijos.".concat(i,".apellido"),render:e=>{let{field:i}=e;return(0,r.jsxs)(u.xJ,{children:[" ",(0,r.jsx)(u.lX,{children:"Apellido"})," ",(0,r.jsx)(u.NI,{children:(0,r.jsx)(c.I,{...i,disabled:em})})," ",(0,r.jsx)(u.zG,{})," "]})}}),(0,r.jsx)(u.Wi,{control:V,name:"familiares.hijos.".concat(i,".nombre"),render:e=>{let{field:i}=e;return(0,r.jsxs)(u.xJ,{children:[" ",(0,r.jsx)(u.lX,{children:"Nombre"})," ",(0,r.jsx)(u.NI,{children:(0,r.jsx)(c.I,{...i,disabled:em})})," ",(0,r.jsx)(u.zG,{})," "]})}}),(0,r.jsx)(u.Wi,{control:V,name:"familiares.hijos.".concat(i,".fechaNacimiento"),render:e=>{let{field:i}=e;return(0,r.jsxs)(u.xJ,{children:[" ",(0,r.jsx)(u.lX,{children:"Fecha Nac."}),(0,r.jsx)(u.NI,{children:(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(N.Z,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground pointer-events-none"}),(0,r.jsx)(c.I,{type:"date",value:i.value?(0,w.WU)(new Date(i.value),"yyyy-MM-dd"):"",onChange:e=>i.onChange(e.target.value?(0,I.D)(e.target.value):null),className:"w-full pl-10",max:T,min:"1900-01-01",disabled:em||!T})]})}),(0,r.jsx)(u.zG,{})]})}}),(0,r.jsx)(u.Wi,{control:V,name:"familiares.hijos.".concat(i,".dni"),render:e=>{let{field:i}=e;return(0,r.jsxs)(u.xJ,{children:[" ",(0,r.jsx)(u.lX,{children:"DNI"})," ",(0,r.jsx)(u.NI,{children:(0,r.jsx)(c.I,{type:"number",...i,disabled:em})})," ",(0,r.jsx)(u.zG,{})," "]})}}),(0,r.jsx)(u.Wi,{control:V,name:"familiares.hijos.".concat(i,".telefono"),render:e=>{let{field:i}=e;return(0,r.jsxs)(u.xJ,{children:[" ",(0,r.jsx)(u.lX,{children:"Tel\xe9fono (Opcional)"})," ",(0,r.jsx)(u.NI,{children:(0,r.jsx)(c.I,{type:"tel",...i,disabled:em})})," ",(0,r.jsx)(u.zG,{})," "]})}}),(0,r.jsx)(u.Wi,{control:V,name:"familiares.hijos.".concat(i,".direccion"),render:e=>{let{field:i}=e;return(0,r.jsxs)(u.xJ,{children:[" ",(0,r.jsx)(u.lX,{children:"Direcci\xf3n (Opcional)"})," ",(0,r.jsx)(u.NI,{children:(0,r.jsx)(c.I,{...i,disabled:em})})," ",(0,r.jsx)(u.zG,{})," "]})}}),(0,r.jsx)(u.Wi,{control:V,name:"familiares.hijos.".concat(i,".email"),render:e=>{let{field:i}=e;return(0,r.jsxs)(u.xJ,{className:"md:col-span-2",children:[" ",(0,r.jsx)(u.lX,{children:"Email (Opcional)"})," ",(0,r.jsx)(u.NI,{children:(0,r.jsx)(c.I,{type:"email",...i,disabled:em})})," ",(0,r.jsx)(u.zG,{})," "]})}})]}),(0,r.jsxs)("h5",{className:"text-sm font-semibold mt-4 mb-2",children:["Documentaci\xf3n Hijo/a ",i+1]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,r.jsx)(P.FileInput,{name:"familiares.hijos.".concat(i,".fotoDniFrente"),label:"DNI Frente",control:V,disabled:em}),(0,r.jsx)(P.FileInput,{name:"familiares.hijos.".concat(i,".fotoDniDorso"),label:"DNI Dorso",control:V,disabled:em}),(0,r.jsx)(P.FileInput,{name:"familiares.hijos.".concat(i,".fotoPerfil"),label:"Foto Perfil",control:V,disabled:em})]})]},e.id)),ea.length<k.fk&&(0,r.jsxs)(o.z,{type:"button",variant:"outline",onClick:()=>er({id:(0,E.Ox)(),apellido:"",nombre:"",fechaNacimiento:new Date,dni:"",relacion:k.$g.HIJO_A,fotoDniFrente:null,fotoDniDorso:null,fotoPerfil:null,telefono:"",direccion:"",email:""}),disabled:em,children:[(0,r.jsx)(v.Z,{className:"mr-2 h-4 w-4"})," Agregar Hijo/a"]})]})]}),"padresMadres"===eo&&(0,r.jsxs)("div",{className:"mb-6 p-4 border rounded-md",children:[(0,r.jsxs)("h4",{className:"text-md font-semibold mb-2",children:["Datos de Padres/Madres (hasta ",k.yP,")"]}),es.map((e,i)=>(0,r.jsxs)("div",{className:"mb-4 p-4 border rounded-md relative bg-muted/20",children:[(0,r.jsxs)(o.z,{type:"button",variant:"ghost",size:"icon",className:"absolute top-2 right-2 text-destructive hover:bg-destructive/10",onClick:()=>el(i),disabled:em,children:[" ",(0,r.jsx)(y.Z,{className:"h-4 w-4"})," "]}),(0,r.jsxs)("p",{className:"font-medium mb-2",children:["Padre/Madre ",i+1]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsx)(u.Wi,{control:V,name:"familiares.padres.".concat(i,".apellido"),render:e=>{let{field:i}=e;return(0,r.jsxs)(u.xJ,{children:[" ",(0,r.jsx)(u.lX,{children:"Apellido"})," ",(0,r.jsx)(u.NI,{children:(0,r.jsx)(c.I,{...i,disabled:em})})," ",(0,r.jsx)(u.zG,{})," "]})}}),(0,r.jsx)(u.Wi,{control:V,name:"familiares.padres.".concat(i,".nombre"),render:e=>{let{field:i}=e;return(0,r.jsxs)(u.xJ,{children:[" ",(0,r.jsx)(u.lX,{children:"Nombre"})," ",(0,r.jsx)(u.NI,{children:(0,r.jsx)(c.I,{...i,disabled:em})})," ",(0,r.jsx)(u.zG,{})," "]})}}),(0,r.jsx)(u.Wi,{control:V,name:"familiares.padres.".concat(i,".fechaNacimiento"),render:e=>{let{field:i}=e;return(0,r.jsxs)(u.xJ,{children:[" ",(0,r.jsx)(u.lX,{children:"Fecha Nac."}),(0,r.jsx)(u.NI,{children:(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(N.Z,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground pointer-events-none"}),(0,r.jsx)(c.I,{type:"date",value:i.value?(0,w.WU)(new Date(i.value),"yyyy-MM-dd"):"",onChange:e=>i.onChange(e.target.value?(0,I.D)(e.target.value):null),className:"w-full pl-10",max:T,min:"1900-01-01",disabled:em||!T})]})}),(0,r.jsx)(u.zG,{})]})}}),(0,r.jsx)(u.Wi,{control:V,name:"familiares.padres.".concat(i,".dni"),render:e=>{let{field:i}=e;return(0,r.jsxs)(u.xJ,{children:[" ",(0,r.jsx)(u.lX,{children:"DNI"})," ",(0,r.jsx)(u.NI,{children:(0,r.jsx)(c.I,{type:"number",...i,disabled:em})})," ",(0,r.jsx)(u.zG,{})," "]})}}),(0,r.jsx)(u.Wi,{control:V,name:"familiares.padres.".concat(i,".telefono"),render:e=>{let{field:i}=e;return(0,r.jsxs)(u.xJ,{children:[" ",(0,r.jsx)(u.lX,{children:"Tel\xe9fono (Opcional)"})," ",(0,r.jsx)(u.NI,{children:(0,r.jsx)(c.I,{type:"tel",...i,disabled:em})})," ",(0,r.jsx)(u.zG,{})," "]})}}),(0,r.jsx)(u.Wi,{control:V,name:"familiares.padres.".concat(i,".direccion"),render:e=>{let{field:i}=e;return(0,r.jsxs)(u.xJ,{children:[" ",(0,r.jsx)(u.lX,{children:"Direcci\xf3n (Opcional)"})," ",(0,r.jsx)(u.NI,{children:(0,r.jsx)(c.I,{...i,disabled:em})})," ",(0,r.jsx)(u.zG,{})," "]})}}),(0,r.jsx)(u.Wi,{control:V,name:"familiares.padres.".concat(i,".email"),render:e=>{let{field:i}=e;return(0,r.jsxs)(u.xJ,{className:"md:col-span-2",children:[" ",(0,r.jsx)(u.lX,{children:"Email (Opcional)"})," ",(0,r.jsx)(u.NI,{children:(0,r.jsx)(c.I,{type:"email",...i,disabled:em})})," ",(0,r.jsx)(u.zG,{})," "]})}})]}),(0,r.jsxs)("h5",{className:"text-sm font-semibold mt-4 mb-2",children:["Documentaci\xf3n Padre/Madre ",i+1]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,r.jsx)(P.FileInput,{name:"familiares.padres.".concat(i,".fotoDniFrente"),label:"DNI Frente",control:V,disabled:em}),(0,r.jsx)(P.FileInput,{name:"familiares.padres.".concat(i,".fotoDniDorso"),label:"DNI Dorso",control:V,disabled:em}),(0,r.jsx)(P.FileInput,{name:"familiares.padres.".concat(i,".fotoPerfil"),label:"Foto Perfil",control:V,disabled:em})]})]},e.id)),es.length<k.yP&&(0,r.jsxs)(o.z,{type:"button",variant:"outline",onClick:()=>en({id:(0,E.Ox)(),apellido:"",nombre:"",fechaNacimiento:new Date,dni:"",relacion:k.$g.PADRE_MADRE,fotoDniFrente:null,fotoDniDorso:null,fotoPerfil:null,telefono:"",direccion:"",email:""}),disabled:em,children:[(0,r.jsx)(v.Z,{className:"mr-2 h-4 w-4"})," Agregar Padre/Madre"]})]}),ei.familiares&&ei.familiares.message&&(0,r.jsx)(u.xJ,{children:(0,r.jsx)(u.zG,{children:ei.familiares.message})}),(null===(e=ei.root)||void 0===e?void 0:e.message)&&(0,r.jsx)(u.xJ,{children:(0,r.jsx)(u.zG,{children:ei.root.message})})]}),3===Z&&(0,r.jsxs)("section",{children:[(0,r.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Revisar y Enviar Solicitud de Cambio"}),(0,r.jsx)("p",{className:"text-muted-foreground mb-4",children:"Por favor, revisa que toda la informaci\xf3n sea correcta antes de enviar la solicitud de cambio. Esta ser\xe1 revisada por administraci\xf3n."}),(0,r.jsxs)("div",{className:"space-y-2 p-4 border rounded-md bg-muted/30",children:[(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Tipo de Grupo Familiar Propuesto:"})," ","conyugeEHijos"===(Q("tipoGrupoFamiliar")||R)?"C\xf3nyuge e Hijos/as":"padresMadres"===(Q("tipoGrupoFamiliar")||R)?"Padres/Madres":"No seleccionado"]}),("conyugeEHijos"===Q("tipoGrupoFamiliar")||"conyugeEHijos"===R)&&(0,r.jsxs)(r.Fragment,{children:[Q("familiares.conyuge")&&(0,r.jsxs)("p",{className:"pl-4",children:[(0,r.jsx)("strong",{children:"C\xf3nyuge:"})," ",Q("familiares.conyuge.nombre")," ",Q("familiares.conyuge.apellido")]}),null===(i=Q("familiares.hijos"))||void 0===i?void 0:i.map((e,i)=>(0,r.jsxs)("p",{className:"pl-4",children:[(0,r.jsxs)("strong",{children:["Hijo/a ",i+1,":"]})," ",e.nombre," ",e.apellido]},"hijo-rev-".concat(i))),(null===(a=Q("familiares.hijos"))||void 0===a?void 0:a.length)===0&&!Q("familiares.conyuge")&&(0,r.jsx)("p",{className:"pl-4 text-muted-foreground",children:"No se proponen c\xf3nyuges ni hijos/as."})]}),("padresMadres"===Q("tipoGrupoFamiliar")||"padresMadres"===R)&&(0,r.jsxs)(r.Fragment,{children:[null===(x=Q("familiares.padres"))||void 0===x?void 0:x.map((e,i)=>(0,r.jsxs)("p",{className:"pl-4",children:[(0,r.jsxs)("strong",{children:["Padre/Madre ",i+1,":"]})," ",e.nombre," ",e.apellido]},"padre-rev-".concat(i))),(null===(G=Q("familiares.padres"))||void 0===G?void 0:G.length)===0&&(0,r.jsx)("p",{className:"pl-4 text-muted-foreground",children:"No se proponen padres/madres."})]})]}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground mt-4",children:"Al enviar, la informaci\xf3n proporcionada quedar\xe1 pendiente de aprobaci\xf3n por la administraci\xf3n."})]})]}),(0,r.jsxs)(d.eW,{className:"flex justify-between",children:[(0,r.jsxs)(o.z,{type:"button",variant:"outline",onClick:()=>{Z>1&&A(e=>e-1)},disabled:1===Z,children:[(0,r.jsx)(D.Z,{className:"mr-2 h-4 w-4"})," Anterior"]}),Z<3?(0,r.jsxs)(o.z,{type:"button",onClick:ec,disabled:em,children:["Siguiente ",(0,r.jsx)(F.Z,{className:"ml-2 h-4 w-4"})]}):(0,r.jsx)(o.z,{type:"submit",disabled:L.formState.isSubmitting||em,children:L.formState.isSubmitting?"Enviando...":"Enviar Solicitud de Cambio"})]})]})]})})}},87992:function(e,i,a){"use strict";a.d(i,{Cd:function(){return d},X:function(){return c},bZ:function(){return o}});var r=a(57437),t=a(2265),s=a(13027),n=a(49354);let l=(0,s.j)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),o=t.forwardRef((e,i)=>{let{className:a,variant:t,...s}=e;return(0,r.jsx)("div",{ref:i,role:"alert",className:(0,n.cn)(l({variant:t}),a),...s})});o.displayName="Alert";let d=t.forwardRef((e,i)=>{let{className:a,...t}=e;return(0,r.jsx)("h5",{ref:i,className:(0,n.cn)("mb-1 font-medium leading-none tracking-tight",a),...t})});d.displayName="AlertTitle";let c=t.forwardRef((e,i)=>{let{className:a,...t}=e;return(0,r.jsx)("div",{ref:i,className:(0,n.cn)("text-sm [&_p]:leading-relaxed",a),...t})});c.displayName="AlertDescription"},81262:function(e,i,a){"use strict";a.r(i),a.d(i,{FileInput:function(){return f}});var r=a(57437),t=a(2265),s=a(39343),n=a(66648),l=a(22023),o=a(22584),d=a(10883),c=a(89733),u=a(77209),m=a(93363);function f(e){let{name:i,label:a,control:f,isEditable:h=!0,aiHint:p,accept:x,...j}=e,{field:g}=(0,s.bc)({name:i,control:f}),b=g.value,v=(0,t.useMemo)(()=>b instanceof FileList&&b.length>0&&b[0].type.startsWith("image/")?URL.createObjectURL(b[0]):"string"==typeof b?b:null,[b]),y=(0,t.useMemo)(()=>b instanceof FileList&&b.length>0?b[0].name:null,[b]);return(0,t.useEffect)(()=>()=>{v&&v.startsWith("blob:")&&URL.revokeObjectURL(v)},[v]),(0,r.jsxs)(m.xJ,{children:[(0,r.jsx)(m.lX,{children:a}),(0,r.jsx)(m.NI,{children:(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsxs)("label",{className:"relative cursor-pointer w-full min-h-[120px] h-[120px] flex flex-col items-center justify-center p-2 border-2 border-dashed rounded-md transition-colors ".concat(h?"hover:border-primary bg-background hover:bg-muted/50":"cursor-not-allowed bg-muted/50"),children:[v?(0,r.jsx)(n.default,{src:v,alt:"Vista previa de ".concat(a),fill:!0,className:"object-contain rounded-md","data-ai-hint":p||"user document photo"}):y?(0,r.jsxs)("div",{className:"text-center p-2 text-muted-foreground",children:[(0,r.jsx)(l.Z,{className:"h-8 w-8 mx-auto mb-2"}),(0,r.jsx)("p",{className:"text-xs break-all",children:y})]}):(0,r.jsxs)("div",{className:"text-center p-2 text-muted-foreground",children:[(0,r.jsx)(o.Z,{className:"h-8 w-8 mx-auto mb-2"}),(0,r.jsx)("p",{className:"text-xs",children:"Subir archivo"})]}),(0,r.jsx)(u.I,{type:"file",className:"hidden",onChange:e=>g.onChange(e.target.files&&e.target.files.length>0?e.target.files:null),disabled:!h,accept:x,...j})]}),h&&b&&(0,r.jsx)(c.z,{type:"button",variant:"ghost",size:"icon",className:"absolute -top-2 -right-2 h-7 w-7 bg-card rounded-full shadow-md hover:bg-destructive/10",onClick:()=>g.onChange(null),children:(0,r.jsx)(d.Z,{className:"h-4 w-4 text-destructive"})})]})}),(0,r.jsx)(m.zG,{})]})}},39630:function(e,i,a){"use strict";a.d(i,{H:function(){return u},V:function(){return c}});var r=a(57437),t=a(2265),s=a(75735),n=a(25419),l=a(26912),o=a(94282),d=a(86763);let c=(0,t.createContext)(void 0),u=e=>{let{children:i}=e,[a,u]=(0,t.useState)(null),[m,f]=(0,t.useState)(null),[h,p]=(0,t.useState)(null),[x,j]=(0,t.useState)(null),[g,b]=(0,t.useState)(!0);(0,t.useEffect)(()=>{let e=()=>{};return n.I8&&(e=(0,s.Aj)(n.I8,async e=>{if(b(!0),e){u(e),console.log("Firebase Auth UID for logged-in user:",e.uid);try{let i=await (0,l.AZ)(e.uid);if(i)f(i.role),p("".concat(i.nombre," ").concat(i.apellido)),j(i.numeroSocio);else{let i=await (0,l.Xt)(e.uid);i?(f(i.role),p(i.name)):(console.warn("User with UID ".concat(e.uid," and email ").concat(e.email," is authenticated but has no profile in 'socios' or 'adminUsers' collections. Assign a role in Firestore to grant access.")),f(null),p(e.displayName||e.email)),j(null)}}catch(i){console.error("AuthContext: Failed to fetch user profile from Firestore.",i),(0,d.Am)({title:"Error de Permisos o Conexi\xf3n",description:"No se pudo cargar tu perfil. Esto puede deberse a un problema de conexi\xf3n o a que las reglas de seguridad de Firestore no permiten el acceso. Contacte al administrador.",variant:"destructive",duration:1e4}),f(null),p(e.displayName||e.email),j(null)}}else u(null),f(null),p(null),j(null);b(!1)})),()=>e()},[]);let v=async()=>{await (0,o.TX)()};return(0,r.jsx)(c.Provider,{value:{isLoggedIn:!!a,user:a,userRole:m,userName:h,loggedInUserNumeroSocio:x,isLoading:g,logout:v},children:i})}},67048:function(e,i,a){"use strict";a.d(i,{a:function(){return s}});var r=a(2265),t=a(39630);let s=()=>{let e=(0,r.useContext)(t.V);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},94282:function(e,i,a){"use strict";a.d(i,{EL:function(){return o},TX:function(){return d},pH:function(){return l}});var r=a(75735),t=a(25419),s=a(86763),n=a(26912);let l=async(e,i)=>{try{if(!t.I8)throw Error("Auth service not initialized.");return(await (0,r.e5)(t.I8,e,i)).user}catch(e){return console.error("Firebase login error:",e),(0,s.Am)({title:"Error de Inicio de Sesi\xf3n",description:"Email o contrase\xf1a incorrectos. Por favor, intente de nuevo.",variant:"destructive"}),null}},o=async e=>{try{if(!t.I8)throw Error("Auth service not initialized.");let i=(await (0,r.Xb)(t.I8,e.email,e.password)).user;await (0,r.ck)(i,{displayName:"".concat(e.nombre," ").concat(e.apellido)});let a=async(e,a)=>e instanceof FileList&&e.length>0?(0,n.cT)(e[0],"socios/".concat(i.uid,"/").concat(a)):null,[s,l,o,d]=await Promise.all([a(e.fotoPerfil,"fotoPerfil.jpg"),a(e.fotoDniFrente,"fotoDniFrente.jpg"),a(e.fotoDniDorso,"fotoDniDorso.jpg"),a(e.fotoCarnet,"fotoCarnet.jpg")]),c={email:e.email,nombre:e.nombre,apellido:e.apellido,fechaNacimiento:e.fechaNacimiento,dni:e.dni,empresa:e.empresa,telefono:e.telefono,direccion:e.direccion,fotoUrl:s,fotoPerfil:s,fotoDniFrente:l,fotoDniDorso:o,fotoCarnet:d,grupoFamiliar:[]};return await (0,n.l1)(i.uid,c,!0),i}catch(i){console.error("Firebase signup error:",i);let e="Ocurri\xf3 un error inesperado al crear la cuenta.";return"auth/email-already-in-use"===i.code&&(e="El email ingresado ya est\xe1 en uso. Por favor, utilice otro."),(0,s.Am)({title:"Error de Registro",description:e,variant:"destructive"}),null}},d=async()=>{try{if(!t.I8)throw Error("Auth service not initialized.");await (0,r.w7)(t.I8)}catch(e){console.error("Error signing out:",e),(0,s.Am)({title:"Error",description:"No se pudo cerrar la sesi\xf3n.",variant:"destructive"})}}},45132:function(e,i,a){"use strict";a.d(i,{e:function(){return s}});var r=a(74546),t=a(11880);function s(e,i){return function(e,i){let a=(0,r.Q)(e);if(isNaN(i))return(0,t.L)(e,NaN);if(!i)return a;let s=a.getDate(),n=(0,t.L)(e,a.getTime());return(n.setMonth(a.getMonth()+i+1,0),s>=n.getDate())?n:(a.setFullYear(n.getFullYear(),n.getMonth(),s),a)}(e,-(12*i))}}},function(e){e.O(0,[4358,139,4868,317,9772,3906,8173,6068,7108,2971,7023,1744],function(){return e(e.s=51484)}),_N_E=e.O()}]);