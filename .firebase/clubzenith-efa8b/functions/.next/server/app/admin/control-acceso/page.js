(()=>{var e={};e.id=567,e.ids=[567],e.modules={47849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},83122:e=>{"use strict";e.exports=require("undici")},6113:e=>{"use strict";e.exports=require("crypto")},9523:e=>{"use strict";e.exports=require("dns")},82361:e=>{"use strict";e.exports=require("events")},57147:e=>{"use strict";e.exports=require("fs")},13685:e=>{"use strict";e.exports=require("http")},85158:e=>{"use strict";e.exports=require("http2")},41808:e=>{"use strict";e.exports=require("net")},22037:e=>{"use strict";e.exports=require("os")},71017:e=>{"use strict";e.exports=require("path")},77282:e=>{"use strict";e.exports=require("process")},12781:e=>{"use strict";e.exports=require("stream")},24404:e=>{"use strict";e.exports=require("tls")},57310:e=>{"use strict";e.exports=require("url")},73837:e=>{"use strict";e.exports=require("util")},59796:e=>{"use strict";e.exports=require("zlib")},71602:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>o.a,__next_app__:()=>u,originalPathname:()=>m,pages:()=>c,routeModule:()=>p,tree:()=>d}),t(73609),t(9457),t(66851),t(35866);var a=t(23191),r=t(88716),i=t(37922),o=t.n(i),l=t(95231),n={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(n[e]=()=>l[e]);t.d(s,n);let d=["",{children:["admin",{children:["control-acceso",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,73609)),"C:\\Users\\Gaton\\mazallegrofirebase\\src\\app\\admin\\control-acceso\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,9457)),"C:\\Users\\Gaton\\mazallegrofirebase\\src\\app\\admin\\layout.tsx"],metadata:{icon:[async e=>(await Promise.resolve().then(t.bind(t,73881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(t.bind(t,66851)),"C:\\Users\\Gaton\\mazallegrofirebase\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,35866,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(t.bind(t,73881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],c=["C:\\Users\\Gaton\\mazallegrofirebase\\src\\app\\admin\\control-acceso\\page.tsx"],m="/admin/control-acceso/page",u={require:t,loadChunk:()=>Promise.resolve()},p=new a.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/admin/control-acceso/page",pathname:"/admin/control-acceso",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},38110:(e,s,t)=>{Promise.resolve().then(t.bind(t,57084))},97840:(e,s,t)=>{Promise.resolve().then(t.bind(t,4959))},40900:(e,s,t)=>{"use strict";t.d(s,{Z:()=>a});/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,t(62881).Z)("Archive",[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]])},28731:(e,s,t)=>{"use strict";t.d(s,{Z:()=>a});/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,t(62881).Z)("Baby",[["path",{d:"M9 12h.01",key:"157uk2"}],["path",{d:"M15 12h.01",key:"1k8ypt"}],["path",{d:"M10 16c.5.3 1.2.5 2 .5s1.5-.2 2-.5",key:"1u7htd"}],["path",{d:"M19 6.3a9 9 0 0 1 1.8 3.9 2 2 0 0 1 0 3.6 9 9 0 0 1-17.6 0 2 2 0 0 1 0-3.6A9 9 0 0 1 12 3c2 0 3.5 1.1 3.5 2.5s-.9 2.5-2 2.5c-.8 0-1.5-.4-1.5-1",key:"5yv0yz"}]])},15188:(e,s,t)=>{"use strict";t.d(s,{Z:()=>a});/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,t(62881).Z)("Banknote",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"2",key:"9lu3g6"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}],["path",{d:"M6 12h.01M18 12h.01",key:"113zkx"}]])},30361:(e,s,t)=>{"use strict";t.d(s,{Z:()=>a});/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,t(62881).Z)("CircleCheckBig",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},69669:(e,s,t)=>{"use strict";t.d(s,{Z:()=>a});/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,t(62881).Z)("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]])},28916:(e,s,t)=>{"use strict";t.d(s,{Z:()=>a});/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,t(62881).Z)("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]])},98908:(e,s,t)=>{"use strict";t.d(s,{Z:()=>a});/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,t(62881).Z)("Gift",[["rect",{x:"3",y:"8",width:"18",height:"4",rx:"1",key:"bkv52"}],["path",{d:"M12 8v13",key:"1c76mn"}],["path",{d:"M19 12v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-7",key:"6wjy6b"}],["path",{d:"M7.5 8a2.5 2.5 0 0 1 0-5A4.8 8 0 0 1 12 8a4.8 8 0 0 1 4.5-5 2.5 2.5 0 0 1 0 5",key:"1ihvrl"}]])},59819:(e,s,t)=>{"use strict";t.d(s,{Z:()=>a});/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,t(62881).Z)("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]])},94909:(e,s,t)=>{"use strict";t.d(s,{Z:()=>a});/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,t(62881).Z)("UsersRound",[["path",{d:"M18 21a8 8 0 0 0-16 0",key:"3ypg7q"}],["circle",{cx:"10",cy:"8",r:"5",key:"o932ke"}],["path",{d:"M22 20c0-3.37-2-6.5-4-8a5 5 0 0 0-.45-8.3",key:"10s06x"}]])},57084:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>v});var a=t(10326),r=t(17577),i=t(90434),o=t(35047),l=t(63993),n=t(91664),d=t(71810),c=t(11890),m=t(46226),u=t(51223),p=t(74131),x=t(82631);function h({className:e,isExpanded:s,onToggle:t}){let r=(0,o.usePathname)(),h=(0,o.useRouter)(),{userRole:f,logout:g}=(0,p.a)(),v=async()=>{await g(),h.push("/login"),h.refresh()},b=l.Q.filter(e=>f&&e.roles.includes(f));return a.jsx(x.pn,{delayDuration:0,children:(0,a.jsxs)("aside",{className:(0,u.cn)("flex flex-col bg-card border-r",e),children:[a.jsx("div",{className:(0,u.cn)("h-16 flex items-center border-b transition-all duration-300",s?"justify-start px-4":"justify-center px-2"),children:a.jsx(i.default,{href:"/dashboard",className:"flex items-center space-x-2",children:s?a.jsx(m.default,{src:"https://placehold.co/153x76.png",alt:"[Tu Logo]","data-ai-hint":"company logo",width:120,height:60,className:"h-auto",priority:!0}):a.jsx(m.default,{src:"https://placehold.co/40x40.png",alt:"[Tu Logo]","data-ai-hint":"club logo",width:40,height:40,className:"h-auto rounded-md",priority:!0})})}),a.jsx("nav",{className:"flex-1 px-2 py-4 space-y-1",children:b.map(e=>(0,a.jsxs)(x.u,{children:[a.jsx(x.aJ,{asChild:!0,children:a.jsx(i.default,{href:e.href,passHref:!0,children:(0,a.jsxs)(n.z,{variant:r.startsWith(e.href)?"secondary":"ghost",className:(0,u.cn)("w-full text-sm h-11",s?"justify-start":"justify-center p-0"),children:[a.jsx(e.icon,{className:(0,u.cn)("h-5 w-5",s&&"mr-3")}),a.jsx("span",{className:(0,u.cn)(!s&&"sr-only"),children:e.title})]})})}),!s&&a.jsx(x._v,{side:"right",children:a.jsx("p",{children:e.title})})]},e.id))}),(0,a.jsxs)("div",{className:"p-2 border-t mt-auto",children:[(0,a.jsxs)(x.u,{children:[a.jsx(x.aJ,{asChild:!0,children:(0,a.jsxs)(n.z,{variant:"ghost",className:(0,u.cn)("w-full text-destructive hover:text-destructive hover:bg-destructive/10",!s&&"justify-center p-0"),onClick:v,children:[a.jsx(d.Z,{className:(0,u.cn)("h-5 w-5",s&&"mr-2")}),a.jsx("span",{className:(0,u.cn)(!s&&"sr-only"),children:"Cerrar Sesi\xf3n"})]})}),!s&&a.jsx(x._v,{side:"right",children:a.jsx("p",{children:"Cerrar Sesi\xf3n"})})]}),t&&(0,a.jsxs)(n.z,{variant:"ghost",className:(0,u.cn)("w-full mt-1",!s&&"justify-center p-0"),onClick:t,children:[a.jsx(c.Z,{className:(0,u.cn)("h-5 w-5 transition-transform",!s&&"rotate-180")}),a.jsx("span",{className:"sr-only",children:"Toggle Sidebar"})]})]})]})})}var f=t(76066),g=t(9664);function v({children:e}){let[s,t]=(0,r.useState)(!0);return(0,a.jsxs)("div",{className:"flex min-h-screen w-full flex-col bg-muted/40",children:[a.jsx(h,{isExpanded:s,onToggle:()=>t(!s),className:(0,u.cn)("hidden md:flex md:fixed md:h-full md:z-10 transition-[width] duration-300 ease-in-out",s?"md:w-64":"md:w-20")}),(0,a.jsxs)("div",{className:(0,u.cn)("flex flex-col transition-[padding-left] duration-300 ease-in-out",s?"md:pl-64":"md:pl-20"),children:[(0,a.jsxs)("header",{className:"sticky top-0 z-30 flex h-14 items-center gap-4 border-b bg-background px-4 sm:px-6 md:hidden",children:[(0,a.jsxs)(f.yo,{children:[a.jsx(f.aM,{asChild:!0,children:(0,a.jsxs)(n.z,{size:"icon",variant:"outline",children:[a.jsx(g.Z,{className:"h-5 w-5"}),a.jsx("span",{className:"sr-only",children:"Toggle Menu"})]})}),a.jsx(f.ue,{side:"left",className:"p-0 w-64",children:a.jsx(h,{isExpanded:!0,className:"flex h-full w-full"})})]}),a.jsx(i.default,{href:"/",className:"flex items-center",children:a.jsx(m.default,{src:"https://placehold.co/153x76.png",alt:"[Tu Logo]","data-ai-hint":"company logo",width:100,height:50,className:"h-auto",priority:!0})})]}),a.jsx("main",{className:"flex flex-1 flex-col gap-4 p-4 sm:gap-8 sm:p-6 lg:p-8",children:e})]})]})}},4959:(e,s,t)=>{"use strict";t.d(s,{ControlAcceso:()=>O});var a=t(10326),r=t(17577),i=t(35342),o=t(29752),l=t(41190),n=t(91664),d=t(3594),c=t(38443),m=t(98908),u=t(28731),p=t(15188),x=t(28916),h=t(40900),f=t(69669),g=t(30361);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let v=(0,t(62881).Z)("Ticket",[["path",{d:"M2 9a3 3 0 0 1 0 6v2a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-2a3 3 0 0 1 0-6V7a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2Z",key:"qn84l0"}],["path",{d:"M13 5v2",key:"dyzc3o"}],["path",{d:"M13 17v2",key:"1ont0d"}],["path",{d:"M13 11v2",key:"1wjjxi"}]]);var b=t(36283),N=t(71810),y=t(32691),j=t(60763),w=t(88307),A=t(94909),C=t(50949),k=t(18019),S=t(15601),$=t(59819),M=t(8457),D=t(38227),E=t(84097),Z=t(78062),q=t(56556),z=t(69654),P=t(44794),I=t(3282),T=t(67001),U=t(46724),G=t(88206),R=t(39420),V=t(94629),_=t(66759),F=t(35047);function O(){let[e,s]=(0,r.useState)(""),[t,O]=(0,r.useState)(null),[B,H]=(0,r.useState)(""),[Q,J]=(0,r.useState)(!1),{toast:L}=(0,E.pm)(),[W,Y]=(0,r.useState)(void 0),X=(0,F.useRouter)(),[K,ee]=(0,r.useState)(null),[es,et]=(0,r.useState)([]),[ea,er]=(0,r.useState)({}),[ei,eo]=(0,r.useState)({}),[el,en]=(0,r.useState)(0),[ed,ec]=(0,r.useState)(0),em=(0,T.c)(new Date,{representation:"date"}),eu=(0,r.useMemo)(()=>(0,M.dz)(new Date),[]),ep=(0,r.useMemo)(()=>!!(K?.ingresosMiembros&&K.ingresosMiembros.length>0),[K]),ex=(0,r.useMemo)(()=>{if(!t)return[];let e=[];return e.push({id:t.id,nombreCompleto:`${t.nombre} ${t.apellido}`,dni:t.dni,fotoUrl:t.fotoUrl||"https://placehold.co/60x60.png",aptoMedico:t.aptoMedico||void 0,fechaNacimiento:t.fechaNacimiento,estadoSocioTitular:t.estadoSocio,relacion:"Titular",isTitular:!0,isFamiliar:!1,isAdherente:!1}),t.grupoFamiliar?.forEach(s=>{let a="https://placehold.co/60x60.png";s.fotoPerfil&&"string"==typeof s.fotoPerfil&&(a=s.fotoPerfil),e.push({id:s.id||s.dni,nombreCompleto:`${s.nombre} ${s.apellido}`,dni:s.dni,fotoUrl:a||void 0,aptoMedico:s.aptoMedico||void 0,fechaNacimiento:s.fechaNacimiento,estadoSocioTitular:t.estadoSocio,relacion:s.relacion,isTitular:!1,isFamiliar:!0,isAdherente:!1})}),t.adherentes?.forEach(s=>{e.push({id:s.id||s.dni,nombreCompleto:`${s.nombre} ${s.apellido}`,dni:s.dni,fotoUrl:(s.fotoPerfil&&"string"==typeof s.fotoPerfil?s.fotoPerfil:void 0)||"https://placehold.co/60x60.png",aptoMedico:s.aptoMedico||void 0,fechaNacimiento:s.fechaNacimiento,estadoSocioTitular:t.estadoSocio,relacion:"Adherente",isTitular:!1,isFamiliar:!1,isAdherente:!0,estadoAdherente:s.estadoAdherente})}),e},[t]),eh=(0,r.useCallback)(async(s=!1)=>{let a=s&&t?(0,M.bG)(t.numeroSocio)||(0,M.bG)(t.dni):(0,M.bG)(e);if(!a.trim()){H("Por favor, ingrese un N\xb0 Socio, DNI o Nombre para buscar."),O(null),ee(null),et([]),Y(void 0),er({}),eo({}),en(0),ec(0);return}J(!0),s||(O(null),ee(null),et([]),Y(void 0),er({}),eo({}),en(0),ec(0));try{let e=await (0,_.g1)(a);if(e){O(e),H(""),Y("socio-info");let s=0;eu||((0,M.Gs)(e.fechaNacimiento)&&s++,e.grupoFamiliar?.forEach(e=>{M.Gs(e.fechaNacimiento)&&s++})),en(s),ec(15*s);let t=(await (0,_.$M)()).find(s=>s.idSocioTitular===e.numeroSocio&&s.fecha===em&&(s.estado===i.a6.ENVIADA||s.estado===i.a6.PROCESADA)),a={};t?(t.listaInvitadosDiarios.forEach(e=>{a[e.dni]=!eu&&!!e.esDeCumpleanos}),ee(t),et(t.listaInvitadosDiarios)):(ee(null),et([])),eo(a)}else H("Persona no encontrada. Verifique los datos e intente nuevamente."),O(null)}catch(e){console.error("Error buscando socio:",e),L({title:"Error de B\xfasqueda",description:"No se pudo completar la b\xfasqueda.",variant:"destructive"}),O(null)}finally{J(!1)}},[e,em,t,L,eu]),ef=(0,r.useMemo)(()=>es.reduce((e,s)=>{let t=ei[s.dni];return!0===t?e+1:!1===t?e:s.esDeCumpleanos&&s.ingresado?e+1:e},0),[es,ei]),eg=e=>{if(!t){L({title:"Error",description:"No se encontr\xf3 el socio titular para esta acci\xf3n.",variant:"destructive"});return}let s=`/carnet?titularId=${t.numeroSocio}`;e.isTitular||(s+=`&memberDni=${e.dni}`),X.push(s)},ev=async e=>{if(!t)return;let s=!1,a="",r="",o=(0,M.b9)(e.aptoMedico,e.fechaNacimiento);if(e.isTitular||e.isFamiliar?"Activo"===t.estadoSocio?(s=!0,a=`Acceso permitido para ${e.nombreCompleto} (${e.relacion}).`,r="V\xe1lido"!==o.status&&"No Aplica"!==o.status?` ADVERTENCIA: Apto M\xe9dico ${o.status}. ${o.message}`:` Apto M\xe9dico: ${o.status}.`):a=`Acceso Denegado. Socio titular ${t.nombre} ${t.apellido} est\xe1 ${t.estadoSocio}.`:e.isAdherente&&("Activo"===t.estadoSocio&&"Activo"===e.estadoAdherente?(s=!0,a=`Acceso permitido para Adherente: ${e.nombreCompleto}.`,r="V\xe1lido"!==o.status&&"No Aplica"!==o.status?` ADVERTENCIA: Apto M\xe9dico ${o.status}. ${o.message}`:` Apto M\xe9dico: ${o.status}.`):"Activo"!==t.estadoSocio?a=`Acceso Denegado. Socio titular ${t.nombre} ${t.apellido} est\xe1 ${t.estadoSocio}.`:"Activo"!==e.estadoAdherente&&(a=`Acceso Denegado. Adherente ${e.nombreCompleto} est\xe1 ${e.estadoAdherente}.`)),s){let s=[...new Set([...K?.ingresosMiembros||[],e.dni])],a=K?{...K,ingresosMiembros:s,titularIngresadoEvento:!0,fechaUltimaModificacion:new Date}:{id:(0,M.Ox)(),idSocioTitular:t.numeroSocio,nombreSocioTitular:`${t.nombre} ${t.apellido}`,fecha:em,listaInvitadosDiarios:[],estado:i.a6.PROCESADA,fechaCreacion:new Date,fechaUltimaModificacion:new Date,titularIngresadoEvento:!0,ingresosMiembros:[e.dni]};try{let e=await (0,_.Tg)(a);ee(e)}catch(e){console.error("Error updating member entry status:",e),L({title:"Error de Base de Datos",description:"No se pudo registrar el ingreso en la base de datos.",variant:"destructive"});return}}L({title:s?"Ingreso Registrado":"Acceso Denegado",description:`${a}${r}`,variant:s?(r.includes("ADVERTENCIA")&&"No Aplica"!==o.status&&o.status,"default"):"destructive",duration:r.includes("ADVERTENCIA")&&"No Aplica"!==o.status&&"V\xe1lido"!==o.status||!s?7e3:5e3})},eb=async e=>{if(!K)return;let s=K.ingresosMiembros?.filter(s=>s!==e.dni)||[],t={...K,ingresosMiembros:s,fechaUltimaModificacion:new Date};try{let s=await (0,_.Tg)(t);ee(s),L({title:"Ingreso Anulado",description:`Se anul\xf3 el registro de ingreso para ${e.nombreCompleto}.`,variant:"default"})}catch(e){console.error("Error updating member entry status:",e),L({title:"Error de Base de Datos",description:"No se pudo anular el ingreso en la base de datos.",variant:"destructive"})}},eN=(e,s)=>{er(t=>({...t,[e]:s}))},ey=(e,s)=>{if(eu&&s){L({title:"Acci\xf3n no permitida",description:`No se pueden registrar invitados de cumplea\xf1os el ${(0,U.WU)(new Date,"dd/MM")}.`,variant:"default"}),eo(s=>({...s,[e]:!1}));return}if(s&&es.reduce((e,s)=>{let t=ei[s.dni];return!0===t?e+1:!1===t?e:s.esDeCumpleanos&&s.ingresado?e+1:e},0)>=ed){L({title:"Cupo Excedido",description:"Se ha alcanzado el l\xedmite de invitados de cumplea\xf1os para este grupo familiar hoy.",variant:"destructive"});return}eo(t=>({...t,[e]:s})),s||er(s=>({...s,[e]:null}))},ej=async e=>{if(!K){L({title:"Error",description:"No hay una lista de invitados diarios activa.",variant:"destructive"});return}let s=K.listaInvitadosDiarios.find(s=>s.dni===e);if(!s){L({title:"Error",description:"No se encontr\xf3 al invitado para registrar el ingreso.",variant:"destructive"});return}if(!ep){L({title:"Acceso Denegado",description:"Un miembro responsable (titular, familiar o adherente) debe registrar su ingreso primero.",variant:"destructive"});return}let t=!!ei[e];if(!s.ingresado&&t&&es.reduce((e,s)=>{let t=ei[s.dni];return!0===t?e+1:!1===t?e:s.esDeCumpleanos&&s.ingresado?e+1:e},0)>=ed){L({title:"Cupo Excedido",description:"Se ha alcanzado el l\xedmite de invitados de cumplea\xf1os para este grupo familiar hoy.",variant:"destructive"});return}if(!s.ingresado){let a=!1;s.fechaNacimiento&&(0,G.J)(new Date(s.fechaNacimiento))&&3>(0,R.o)(new Date,new Date(s.fechaNacimiento))&&(a=!0);let r=!t&&!a,i=ea[e]||null;if(r&&!i){L({title:"Error",description:`Por favor, seleccione un m\xe9todo de pago para ${s.nombre}.`,variant:"destructive"});return}}let a=!s.ingresado,r=!1;s.fechaNacimiento&&(0,G.J)(new Date(s.fechaNacimiento))&&3>(0,R.o)(new Date,new Date(s.fechaNacimiento))&&(r=!0);let i={...s,ingresado:a,esDeCumpleanos:t,metodoPago:a?t||r?null:ea[e]:s.metodoPago};try{let s={...K,listaInvitadosDiarios:K.listaInvitadosDiarios.map(s=>s.dni===e?i:s)};await (0,_.cG)(s),et(s.listaInvitadosDiarios),ee(s),L({title:`Ingreso Invitado ${a?"Registrado":"Anulado"}`,description:`${i.nombre} ${i.apellido} ha sido ${a?"marcado como ingresado":"desmarcado"}.`}),er(s=>({...s,[e]:null}))}catch(e){console.error("Error actualizando ingreso de invitado:",e),L({title:"Error de Base de Datos",description:"No se pudo registrar el cambio en la base de datos.",variant:"destructive"})}},ew=(e,s,t)=>{if(t)return(0,a.jsxs)(c.C,{variant:"secondary",className:"text-xs bg-pink-500 hover:bg-pink-600 text-white",children:[a.jsx(m.Z,{className:"mr-1 h-3 w-3"})," Cumplea\xf1os"]});if(s)return(0,a.jsxs)(c.C,{variant:"secondary",className:"text-xs bg-purple-500 hover:bg-purple-600 text-white",children:[a.jsx(u.Z,{className:"mr-1 h-3 w-3"})," Gratuito (Menor)"]});if(!e)return null;let r="outline",i="",o=null;switch(e){case"Efectivo":r="default",i="bg-green-500 hover:bg-green-600 text-white",o=p.Z;break;case"Transferencia":r="default",i="bg-blue-500 hover:bg-blue-600 text-white",o=x.Z;break;case"Caja":r="default",i="bg-orange-500 hover:bg-orange-600 text-white",o=h.Z}return(0,a.jsxs)(c.C,{variant:r,className:`text-xs ${i}`,children:[" ",o&&a.jsx(o,{className:"mr-1 h-3 w-3"})," ",e]})},eA=!1,eC="",ek="bg-red-500/10 hover:bg-red-500/20 border-red-500",eS=a.jsx(f.Z,{className:"h-8 w-8 text-red-600 mr-3"}),e$="text-red-700";t&&("Activo"===t.estadoSocio?(eA=!0,eC="Socio titular ACTIVO. Puede ingresar.",ek="bg-green-500/10 hover:bg-green-500/20 border-green-500",eS=a.jsx(g.Z,{className:"h-8 w-8 text-green-600 mr-3"}),e$="text-green-700"):eC=`Socio titular ${t.estadoSocio.toUpperCase()}. NO PUEDE INGRESAR.`);let eM=e=>{let s=null,r=null,i="border-gray-300",l=!1,u=(0,M.b9)(e.aptoMedico,e.fechaNacimiento),p=K?.ingresosMiembros?.includes(e.dni);e.isTitular||e.isFamiliar?(s=a.jsx(c.C,{variant:t?.estadoSocio==="Activo"?"default":"destructive",className:t?.estadoSocio==="Activo"?"bg-green-600 text-white":"bg-red-600 text-white",children:t?.estadoSocio}),r=(0,a.jsxs)("div",{className:`p-2 rounded-md text-xs ${u.colorClass.replace("text-","text-").replace("bg-","bg-opacity-10 ")} border ${u.colorClass.replace("text-","border-")}`,children:[(0,a.jsxs)("span",{className:"font-medium",children:["Apto M\xe9dico (Obs.): $",u.status,"."]})," $",u.message,"."]}),l=t?.estadoSocio==="Activo",i=t?.estadoSocio==="Activo"?"border-green-400":"border-red-400",t?.estadoSocio==="Activo"&&"V\xe1lido"!==u.status&&"No Aplica"!==u.status&&(i="border-orange-400")):e.isAdherente&&(s=a.jsx(c.C,{variant:"Activo"===e.estadoAdherente?"default":"secondary",className:"Activo"===e.estadoAdherente?"bg-green-500":"bg-slate-500",children:e.estadoAdherente}),r=(0,a.jsxs)("div",{className:`p-2 rounded-md text-xs ${u.colorClass.replace("text-","text-").replace("bg-","bg-opacity-10 ")} border ${u.colorClass.replace("text-","border-")}`,children:[(0,a.jsxs)("span",{className:"font-medium",children:["Apto M\xe9dico (Adh.): $",u.status,"."]})," $",u.message,"."]}),l=t?.estadoSocio==="Activo"&&"Activo"===e.estadoAdherente,i=t?.estadoSocio==="Activo"&&"Activo"===e.estadoAdherente?"border-green-300":"border-red-300",t?.estadoSocio==="Activo"&&"Activo"===e.estadoAdherente&&"V\xe1lido"!==u.status&&"No Aplica"!==u.status&&(i="border-orange-300"));let x=e.fotoUrl||"https://placehold.co/60x60.png";return(0,a.jsxs)(o.Zb,{className:`p-4 ${i} bg-card shadow-sm`,children:[(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row items-center gap-4",children:[(0,a.jsxs)(d.qE,{className:"h-16 w-16 border-2 border-muted",children:[a.jsx(d.F$,{src:x,alt:e.nombreCompleto,"data-ai-hint":"member photo"}),a.jsx(d.Q5,{className:"text-xl",children:e.nombreCompleto.split(" ").map(e=>e[0]).join("").toUpperCase()})]}),(0,a.jsxs)("div",{className:"flex-1 text-center sm:text-left",children:[(0,a.jsxs)("div",{className:"font-semibold text-lg text-foreground flex items-center",children:[e.nombreCompleto,a.jsx(c.C,{variant:"outline",className:"ml-2 align-middle",children:e.relacion}),(0,M.Gs)(e.fechaNacimiento)&&(0,a.jsxs)(c.C,{variant:"secondary",className:"ml-2 bg-pink-500 text-white",children:[a.jsx(m.Z,{className:"mr-1 h-3.5 w-3.5"})," \xa1Hoy Cumple!"]})]}),(0,a.jsxs)("p",{className:"text-sm text-muted-foreground",children:["DNI: ",e.dni]}),e.isTitular&&t&&(0,a.jsxs)("div",{className:"text-sm text-muted-foreground",children:["N\xb0 Socio: ",t.numeroSocio," | Estado Club: ",s]}),e.isAdherente&&(0,a.jsxs)("div",{className:"text-sm text-muted-foreground",children:["Estado Adherente: ",s]})]}),(0,a.jsxs)("div",{className:"flex flex-col items-center gap-2 pt-2 sm:pt-0 sm:ml-auto",children:[!e.isAdherente&&(0,a.jsxs)(n.z,{variant:"outline",size:"sm",onClick:()=>eg(e),className:"w-full sm:w-auto",children:[a.jsx(v,{className:"mr-2 h-4 w-4"})," Ver Carnet"]}),e.isAdherente&&(0,a.jsxs)(n.z,{variant:"ghost",size:"sm",className:"w-full sm:w-auto text-xs text-muted-foreground",children:[a.jsx(b.Z,{className:"mr-2 h-3 w-3"})," Carnet Adh. (Sim.)"]}),p?(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row items-center gap-2 w-full sm:w-auto",children:[(0,a.jsxs)(c.C,{variant:"default",className:"bg-green-600 hover:bg-green-700 text-white py-1.5 px-3 text-xs sm:text-sm whitespace-nowrap w-full justify-center sm:w-auto",children:[a.jsx(g.Z,{className:"mr-1.5 h-4 w-4"}),"Ingres\xf3"]}),(0,a.jsxs)(n.z,{variant:"outline",size:"sm",onClick:()=>eb(e),className:"w-full sm:w-auto",children:[a.jsx(N.Z,{className:"mr-2 h-4 w-4"})," Anular Ingreso"]})]}):(0,a.jsxs)(n.z,{variant:"default",size:"sm",onClick:()=>ev(e),className:"w-full sm:w-auto",disabled:!l,children:[a.jsx(y.Z,{className:"mr-2 h-4 w-4"})," Registrar Ingreso"]})]})]}),r&&(0,a.jsxs)(a.Fragment,{children:[a.jsx(Z.Z,{className:"my-3"}),r]})]},e.id)};return a.jsx("div",{className:"space-y-8",children:(0,a.jsxs)(o.Zb,{className:"w-full max-w-3xl mx-auto shadow-xl",children:[(0,a.jsxs)(o.Ol,{children:[(0,a.jsxs)(o.ll,{className:"text-2xl flex items-center",children:[a.jsx(j.Z,{className:"mr-3 h-7 w-7 text-primary"})," Control de Acceso"]}),a.jsx(o.SZ,{children:"Busque cualquier socio, familiar o adherente por su DNI, Nombre, Apellido o N\xb0 de Socio (del titular)."})]}),(0,a.jsxs)(o.aY,{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex space-x-2",children:[a.jsx(l.I,{type:"text",placeholder:"Buscar por DNI, Nombre o N\xb0 Socio de cualquier miembro",value:e,onChange:e=>s(e.target.value),onKeyPress:e=>{"Enter"===e.key&&eh()},className:"flex-grow"}),(0,a.jsxs)(n.z,{onClick:()=>eh(),disabled:Q,children:[a.jsx(w.Z,{className:"mr-2 h-4 w-4"})," ",Q?"Buscando...":"Buscar"]})]}),B&&a.jsx("p",{className:"text-sm text-center text-muted-foreground",children:B}),Q&&!t&&(0,a.jsxs)("div",{className:"pt-4 space-y-3",children:[a.jsx(D.O,{className:"h-24 w-24 rounded-full mx-auto"}),a.jsx(D.O,{className:"h-6 w-3/4 mx-auto"}),a.jsx(D.O,{className:"h-4 w-1/2 mx-auto"}),a.jsx(D.O,{className:"h-10 w-full"})]}),t&&!Q&&a.jsx(q.UQ,{type:"single",collapsible:!0,className:"w-full",value:W,onValueChange:Y,children:(0,a.jsxs)(q.Qd,{value:"socio-info",children:[a.jsx(q.o4,{className:`p-4 rounded-lg text-left ${ek}`,children:a.jsx("div",{className:"flex items-center justify-between w-full",children:(0,a.jsxs)("div",{className:"flex items-center",children:[eS,(0,a.jsxs)("div",{children:[(0,a.jsxs)("h3",{className:`text-lg font-semibold ${e$}`,children:["Socio Titular: ",t.nombre," ",t.apellido," (N\xb0: ",t.numeroSocio,")",(0,M.Gs)(t.fechaNacimiento)&&a.jsx(c.C,{variant:"default",className:"ml-2 bg-pink-500 text-white",children:"\xa1Hoy Cumple!"})]}),a.jsx("div",{className:`text-sm ${eA?"text-green-600":"text-red-600"}`,children:eC})]})]})})}),(0,a.jsxs)(q.vF,{className:"pt-0",children:[(0,a.jsxs)("div",{className:"border-t border-border px-4 py-4",children:[a.jsx("p",{className:"text-xs text-muted-foreground mb-4 text-center",children:"Verifique el estado individual y registre el ingreso de cada miembro. El ingreso general depende del estado del socio titular."}),a.jsx("div",{className:"space-y-4",children:ex.map(e=>eM(e))})]}),K&&(0,a.jsxs)("div",{className:"border-t border-border px-4 py-4 mt-6",children:[(0,a.jsxs)("h4",{className:"text-lg font-semibold mb-3 flex items-center",children:[a.jsx(A.Z,{className:"mr-2 h-5 w-5 text-primary"}),"Invitados Diarios (Hoy: ",(0,U.WU)((0,V.D)(em),"dd/MM/yyyy"),")"]}),eu?(0,a.jsxs)("p",{className:"text-sm text-red-600 bg-red-100 p-2 rounded-md mb-3",children:[a.jsx(C.Z,{className:"inline mr-1 h-4 w-4"})," No se permiten invitados de cumplea\xf1os en esta fecha (",(0,U.WU)(new Date,"dd/MM"),")."]}):el>0?(0,a.jsxs)("p",{className:"text-sm text-pink-600 bg-pink-100 p-2 rounded-md mb-3",children:[a.jsx(m.Z,{className:"inline mr-1 h-4 w-4"})," Este grupo familiar tiene ",el," cumplea\xf1ero(s) hoy. Cupo total de invitados de cumplea\xf1os: ",ed,". Utilizado hoy: ",ef,". Disponibles: ",Math.max(0,ed-ef),"."]}):(0,a.jsxs)("p",{className:"text-sm text-blue-600 bg-blue-100 p-2 rounded-md mb-3",children:[a.jsx(k.Z,{className:"inline mr-1 h-4 w-4"})," Este grupo familiar no tiene cumplea\xf1eros hoy, por lo que no aplica el cupo especial de invitados de cumplea\xf1os."]}),!ep&&(0,a.jsxs)("p",{className:"text-sm text-orange-600 bg-orange-100 p-2 rounded-md mb-3",children:[a.jsx(S.Z,{className:"inline mr-1 h-4 w-4"})," Un miembro responsable (titular, familiar o adherente) debe registrar su ingreso primero para habilitar el registro de invitados diarios."]}),ep&&(0,a.jsxs)("p",{className:"text-sm text-green-600 bg-green-100 p-2 rounded-md mb-3",children:[a.jsx($.Z,{className:"inline mr-1 h-4 w-4"})," Un miembro responsable ya registr\xf3 su ingreso. Puede proceder con los invitados diarios."]}),(0,a.jsxs)("div",{className:"space-y-3 max-h-80 overflow-y-auto pr-2",children:[es.map(e=>{let s=!1;(0,G.J)(e.fechaNacimiento)&&3>(0,R.o)(new Date,e.fechaNacimiento)&&(s=!0);let t=!!ei[e.dni],r=eu||0===el||ef>=ed&&!t;return a.jsx(o.Zb,{className:`p-3 ${e.ingresado?"bg-green-500/10":"bg-card"}`,children:(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-2",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("p",{className:"font-medium text-sm flex items-center",children:[e.nombre," ",e.apellido,s&&a.jsx(u.Z,{className:"ml-2 h-4 w-4 text-purple-500"}),(0,M.Gs)(e.fechaNacimiento)&&(0,a.jsxs)(c.C,{variant:"secondary",className:"ml-2 text-xs bg-pink-500 hover:bg-pink-600 text-white",children:[a.jsx(m.Z,{className:"mr-1 h-3 w-3"})," \xa1Hoy Cumple!"]})]}),e.ingresado&&ew(e.metodoPago,s,!eu&&e.esDeCumpleanos)]}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground",children:["DNI: ",e.dni,e.fechaNacimiento&&` | Nac: ${(0,M.p6)(e.fechaNacimiento)}`]})]}),(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row items-start sm:items-center gap-2 sm:gap-4 w-full sm:w-auto",children:[!e.ingresado&&ep&&!s&&(0,a.jsxs)("div",{className:"flex items-center space-x-2 py-1 sm:border-2 sm:border-pink-500 sm:p-1",children:[a.jsx(z.X,{id:`cumple-diario-${e.dni}`,checked:!eu&&!!ei[e.dni],onCheckedChange:s=>ey(e.dni,!!s),disabled:r}),(0,a.jsxs)(P._,{htmlFor:`cumple-diario-${e.dni}`,className:`text-xs font-normal cursor-pointer ${r?"text-muted-foreground":""}`,children:["Es Inv. Cumplea\xf1os ",eu?"(No disponible hoy)":""]})]}),!e.ingresado&&ep&&!s&&!ei[e.dni]&&a.jsx(I.E,{onValueChange:s=>eN(e.dni,s),defaultValue:ea[e.dni]||void 0,className:"flex flex-col sm:flex-row gap-1 sm:gap-3 py-1 sm:py-0 items-start sm:items-center",children:["Efectivo","Transferencia","Caja"].map(s=>(0,a.jsxs)("div",{className:"flex items-center space-x-1.5",children:[a.jsx(I.m,{value:s,id:`diario-${e.dni}-${s}`,className:"h-3.5 w-3.5"}),a.jsx(P._,{htmlFor:`diario-${e.dni}-${s}`,className:"text-xs font-normal cursor-pointer",children:s})]},s))})]}),a.jsx("div",{className:"flex items-center space-x-2 self-end sm:self-center pt-2 sm:pt-0",children:a.jsx(n.z,{size:"sm",variant:e.ingresado?"outline":"default",onClick:()=>ej(e.dni),disabled:!ep||!e.ingresado&&!s&&!(!eu&&ei[e.dni])&&!ea[e.dni],className:"min-w-[120px]",children:e.ingresado?"Anular Ingreso":"Registrar Ingreso"})})]})},e.dni)}),0===es.length&&a.jsx("p",{className:"text-sm text-muted-foreground",children:"No hay invitados diarios registrados para este socio hoy."})]})]})]})]})})]})]})})}},56556:(e,s,t)=>{"use strict";t.d(s,{Qd:()=>d,UQ:()=>n,o4:()=>c,vF:()=>m});var a=t(10326),r=t(17577),i=t(57793),o=t(941),l=t(51223);let n=i.fC,d=r.forwardRef(({className:e,...s},t)=>a.jsx(i.ck,{ref:t,className:(0,l.cn)("border-b",e),...s}));d.displayName="AccordionItem";let c=r.forwardRef(({className:e,children:s,...t},r)=>a.jsx(i.h4,{className:"flex",children:(0,a.jsxs)(i.xz,{ref:r,className:(0,l.cn)("flex flex-1 items-center justify-between py-4 font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180",e),...t,children:[s,a.jsx(o.Z,{className:"h-4 w-4 shrink-0 transition-transform duration-200"})]})}));c.displayName=i.xz.displayName;let m=r.forwardRef(({className:e,children:s,...t},r)=>a.jsx(i.VY,{ref:r,className:"overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down",...t,children:a.jsx("div",{className:(0,l.cn)("pb-4 pt-0",e),children:s})}));m.displayName=i.VY.displayName},3594:(e,s,t)=>{"use strict";t.d(s,{F$:()=>n,Q5:()=>d,qE:()=>l});var a=t(10326),r=t(17577),i=t(4150),o=t(51223);let l=r.forwardRef(({className:e,...s},t)=>a.jsx(i.fC,{ref:t,className:(0,o.cn)("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",e),...s}));l.displayName=i.fC.displayName;let n=r.forwardRef(({className:e,...s},t)=>a.jsx(i.Ee,{ref:t,className:(0,o.cn)("aspect-square h-full w-full",e),...s}));n.displayName=i.Ee.displayName;let d=r.forwardRef(({className:e,...s},t)=>a.jsx(i.NY,{ref:t,className:(0,o.cn)("flex h-full w-full items-center justify-center rounded-full bg-muted",e),...s}));d.displayName=i.NY.displayName},38443:(e,s,t)=>{"use strict";t.d(s,{C:()=>l});var a=t(10326);t(17577);var r=t(79360),i=t(51223);let o=(0,r.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function l({className:e,variant:s,...t}){return a.jsx("div",{className:(0,i.cn)(o({variant:s}),e),...t})}},3282:(e,s,t)=>{"use strict";t.d(s,{E:()=>n,m:()=>d});var a=t(10326),r=t(17577),i=t(18623),o=t(53982),l=t(51223);let n=r.forwardRef(({className:e,...s},t)=>a.jsx(i.fC,{className:(0,l.cn)("grid gap-2",e),...s,ref:t}));n.displayName=i.fC.displayName;let d=r.forwardRef(({className:e,...s},t)=>a.jsx(i.ck,{ref:t,className:(0,l.cn)("aspect-square h-4 w-4 rounded-full border border-primary text-primary ring-offset-background focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),...s,children:a.jsx(i.z$,{className:"flex items-center justify-center",children:a.jsx(o.Z,{className:"h-2.5 w-2.5 fill-current text-current"})})}));d.displayName=i.ck.displayName},38227:(e,s,t)=>{"use strict";t.d(s,{O:()=>i});var a=t(10326),r=t(51223);function i({className:e,...s}){return a.jsx("div",{className:(0,r.cn)("animate-pulse rounded-md bg-muted",e),...s})}},73609:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>m,metadata:()=>c});var a=t(19510),r=t(68570);let i=(0,r.createProxy)(String.raw`C:\Users\Gaton\mazallegrofirebase\src\components\acceso\ControlAcceso.tsx`),{__esModule:o,$$typeof:l}=i;i.default;let n=(0,r.createProxy)(String.raw`C:\Users\Gaton\mazallegrofirebase\src\components\acceso\ControlAcceso.tsx#ControlAcceso`);var d=t(71872);let c={title:`Control de Acceso - ${d.J.name}`,description:"Verifica el estado de los socios para el ingreso al club."};function m(){return a.jsx("div",{className:"container mx-auto py-8",children:a.jsx(n,{})})}},9457:(e,s,t)=>{"use strict";t.r(s),t.d(s,{$$typeof:()=>o,__esModule:()=>i,default:()=>l});var a=t(68570);let r=(0,a.createProxy)(String.raw`C:\Users\Gaton\mazallegrofirebase\src\app\admin\layout.tsx`),{__esModule:i,$$typeof:o}=r;r.default;let l=(0,a.createProxy)(String.raw`C:\Users\Gaton\mazallegrofirebase\src\app\admin\layout.tsx#default`)},34478:(e,s,t)=>{"use strict";t.d(s,{f:()=>l});var a=t(17577),r=t(45226),i=t(10326),o=a.forwardRef((e,s)=>(0,i.jsx)(r.WV.label,{...e,ref:s,onMouseDown:s=>{s.target.closest("button, input, select, textarea")||(e.onMouseDown?.(s),!s.defaultPrevented&&s.detail>1&&s.preventDefault())}}));o.displayName="Label";var l=o}};var s=require("../../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),a=s.X(0,[948,266,621,256,704,65,620,540],()=>t(71602));module.exports=a})();